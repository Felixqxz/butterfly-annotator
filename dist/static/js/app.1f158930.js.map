{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?a022","webpack:///./src/App.vue?0900","webpack:///./src/components/Header.vue?6dba","webpack:///./src/errors/handler.js","webpack:///src/components/Header.vue","webpack:///./src/components/Header.vue?3232","webpack:///./src/components/Header.vue","webpack:///./src/components/Footer.vue?f458","webpack:///src/components/Footer.vue","webpack:///./src/components/Footer.vue?3384","webpack:///./src/components/Footer.vue","webpack:///src/App.vue","webpack:///./src/App.vue?4c4f","webpack:///./src/App.vue","webpack:///./src/components/AnnotateImage.vue?9488","webpack:///./src/components/DescriptionBit.vue?f3e9","webpack:///src/components/DescriptionBit.vue","webpack:///./src/components/DescriptionBit.vue?9d89","webpack:///./src/components/DescriptionBit.vue","webpack:///src/components/AnnotateImage.vue","webpack:///./src/components/AnnotateImage.vue?ff53","webpack:///./src/components/AnnotateImage.vue","webpack:///./src/components/ImageList.vue?2e16","webpack:///./src/components/PermissionBadge.vue?a131","webpack:///src/components/PermissionBadge.vue","webpack:///./src/components/PermissionBadge.vue?0a72","webpack:///./src/components/PermissionBadge.vue","webpack:///src/components/ImageList.vue","webpack:///./src/components/ImageList.vue?f05e","webpack:///./src/components/ImageList.vue","webpack:///./src/components/Login.vue?0d9d","webpack:///src/components/Login.vue","webpack:///./src/components/Login.vue?1138","webpack:///./src/components/Login.vue","webpack:///./src/components/Register.vue?6c67","webpack:///src/components/Register.vue","webpack:///./src/components/Register.vue?0ffc","webpack:///./src/components/Register.vue","webpack:///./src/components/BankList.vue?aabc","webpack:///src/components/BankList.vue","webpack:///./src/components/BankList.vue?0a82","webpack:///./src/components/BankList.vue","webpack:///./src/components/Settings.vue?d52e","webpack:///./src/components/ProfilePicture.vue?9ee1","webpack:///src/components/ProfilePicture.vue","webpack:///./src/components/ProfilePicture.vue?1bab","webpack:///./src/components/ProfilePicture.vue","webpack:///src/components/Settings.vue","webpack:///./src/components/Settings.vue?fbdf","webpack:///./src/components/Settings.vue","webpack:///./src/components/Profile.vue?4522","webpack:///src/components/Profile.vue","webpack:///./src/components/Profile.vue?c6fc","webpack:///./src/components/Profile.vue","webpack:///./src/router/index.js","webpack:///./src/store/auth.js","webpack:///./src/store/images.js","webpack:///./src/store/profiles.js","webpack:///./src/store/index.js","webpack:///./src/permission.js","webpack:///./src/main.js","webpack:///./src/components/Footer.vue?8387","webpack:///./src/components/Header.vue?abc2","webpack:///./src/components/BankList.vue?d555","webpack:///./src/components/ImageList.vue?b6b5","webpack:///./src/components/ProfilePicture.vue?77dd","webpack:///./src/components/AnnotateImage.vue?0309","webpack:///./src/components/Settings.vue?cfac","webpack:///./src/components/DescriptionBit.vue?0e28"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","staticRenderFns","_v","directives","rawName","isLoggedIn","expression","scopedSlots","_u","fn","_s","username","proxy","on","$event","redirectToProfile","logout","handleError","toast","title","message","variant","solid","computed","methods","doLogOut","then","_","$router","user","component","_m","components","Header","Footer","trackMouse","modifiers","staticStyle","bankId","hasPreviousImage","previousImage","theme","arrow","arrowType","saveAnnotations","hasNextImage","nextImage","undoDisabled","undo","redoDisabled","redo","formDummyId","descriptionOptions","filter","b","disabled","descriptionOfSelectedPolygon","authorOfSelectedPolygon","checkTextSelection","_l","createChunks","bit","start","text","handleBitClick","author","suggested","canAddBit","addTextBit","tooltipContent","badgeVariant","clickHandler","startIndex","props","type","String","required","Number","Function","Boolean","Polygon","dots","Action","HistoryNode","next","previous","action","DescriptionBit","imageData","availablePolygons","selectedBits","selectedPolygon","chunkedDescription","mousePosX","mousePosY","previousTippy","firstHistoryNode","lastHistoryNode","currentHistoryNode","watch","to","from","toRemove","document","getElementById","parentNode","removeChild","destroy","initializeAll","hasDescription","hasNoDescription","search","annotation","annotations","find","polygon","description","substring","end","ret","event","pageX","pageY","path","hasPrevious","go","hasNext","selectedDescription","formActualId","posDiv","style","left","top","content","innerHTML","replace","interactive","setTimeout","show","previousEnd","selected","last","findIndex","a","remPred","id","map","x","Math","floor","y","sendAnnotations","imageId","$route","params","annot","res","ids","$bvToast","indexOf","trim","selection","getSelection","rawText","toString","some","selectedText","sort","empty","current","node","script","p5","disableFriendlyErrors","connectDotsOpen","color","close","stroke","currentPoint","nextPoint","line","first","noStroke","fill","dot","ellipse","MOUSE_RAD","EPS","MOUSE_STROKE_WEIGHT","STROKE_WEIGHT","DELETE_KEY","SHIFT","MAX_FPS","colorSequence","closestPointInRadius","mousePosition","createVector","mouseX","mouseY","closeEnough","polygonDistance","distMin","argMin","pointA","pointB","lineX","lineY","diffX","diffY","compX","compY","dx","dy","dist","closestLineInRadius","polygonArgmin","dotsArgmin","minDist","POSITIVE_INFINITY","distance","index","mouseInCanvas","width","distanceSquared","u","v","display","nextIndex","deletePolygon","history","objPolygon","assign","copySelected","nowAnnot","pushHistory","currentPoints","annotateImage","undefined","movedPoint","movedPointOriginalLocation","setup","createCanvas","height","loadImage","frameRate","draw","image","strokeWeight","dotIdx","forEach","closest","keyIsDown","cursor","HAND","MOVE","ARROW","keyPressed","keyCode","ESCAPE","prev","hide","UNDO_KEYCODE","REDO_KEYCODE","mousePressed","mouseReleased","isVisible","position","location","point","createTooltip","pop","second","tip","poly","fetchImageData","points","regionInfo","split","rawPoint","rawCoord","suggestions","suggestion","addAnnotation","bankName","currentAccess","deleteBank","downloadJson","_k","preventDefault","domProps","target","composing","searchText","$hostname","url","lastEditor","_e","fullDescription","hasPermissionToAdd","ref","model","callback","$$v","targetUser","permissionOptions","selectedLevel","addUser","access","levelToVariant","level","levelToTitle","removeUser","colorVariant","permissionTitle","PermissionBadge","images","userAccesses","toLowerCase","includes","listImages","listAccesses","requestPermission","requestJson","requestDeleteBank","users","userInfo","$refs","relistAccesses","blob","Blob","JSON","stringify","createElement","href","URL","createObjectURL","download","click","revokeObjectURL","fetchImageList","validateState","submitForm","form","$set","veeErrors","password","has","formData","$validator","validateAll","valid","logIn","registrationForm","email","confirmedPassword","register","beginDrag","arguments","showUpload","bank","class","stopDrag","chooseFile","bankFile","checkFiles","clearSelection","uploadBank","availableBanks","listBanks","req","e","stopPropagation","transfer","dataTransfer","types","effectAllowed","dropEffect","files","endsWith","file","FormData","append","uploadBankRemote","updateBanks","currentUser","picture","editable","openUploadModal","pictureToUpload","submitImage","cancel","$bvModal","uploadProfilePicture","ProfilePicture","profilePicture","imagePlaceholder","fetchUserData","Vue","use","Router","base","process","routes","BankList","AnnotateImage","ImageList","Login","meta","noAuth","Register","Settings","Profile","state","mutations","setUserInfo","deleteInfo","actions","commit","axios","post","logOut","registerAccount","getters","Cookies","dispatch","put","targetName","requestBankJson","headers","Vuex","userData","Store","auth","profiles","plugins","createPersistedState","getState","parse","setState","router","beforeEach","defaults","withCredentials","apiUrl","baseURL","BootstrapVue","BootstrapVueIcons","VeeValidate","inject","fieldsBagName","errorBagName","VueTippy","directive","TippyComponent","config","productionTip","store","h","App","$mount"],"mappings":"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","file":"static/js/app.1f158930.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('Header'),_c('router-view',{staticClass:\"container container-fluid\"}),_c('Footer')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-navbar',{staticClass:\"mb-5\",attrs:{\"toggleable\":\"lg\",\"type\":\"dark\",\"variant\":\"dark\"}},[_c('b-navbar-brand',[_c('router-link',{attrs:{\"to\":\"/\"}},[_vm._v(\"Butterfly annotator\")])],1),_c('b-navbar-toggle',{attrs:{\"target\":\"nav-collapse\"}}),_c('b-collapse',{attrs:{\"id\":\"nav-collapse\",\"is-nav\":\"\"}},[_c('b-navbar-nav',{staticClass:\"ml-auto\"},[_c('b-navbar-nav',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isLoggedIn),expression:\"!isLoggedIn\"}]},[_c('b-nav-item',[_c('router-link',{attrs:{\"to\":\"/register\"}},[_vm._v(\"Register\")])],1)],1),_c('b-navbar-nav',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isLoggedIn),expression:\"!isLoggedIn\"}]},[_c('b-nav-item',[_c('router-link',{attrs:{\"to\":\"/login\"}},[_vm._v(\"Login\")])],1)],1),_c('b-nav-item-dropdown',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isLoggedIn),expression:\"isLoggedIn\"}],attrs:{\"right\":\"\"},scopedSlots:_vm._u([{key:\"button-content\",fn:function(){return [_c('em',[_vm._v(_vm._s(_vm.username()))])]},proxy:true}])},[_c('b-dropdown-item',{on:{\"click\":function($event){return _vm.redirectToProfile()}}},[_vm._v(\"Profile\")]),_c('b-dropdown-item',{on:{\"click\":function($event){return _vm.logout()}}},[_vm._v(\"Sign Out\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const handleError = (toast, title, message) => {\r\n    toast.toast(message, {\r\n        title,\r\n        variant: 'danger',\r\n        solid: true,\r\n    })\r\n}\r\n\r\nexport default handleError\r\n","<template>\r\n  <div>\r\n    <b-navbar toggleable=\"lg\" type=\"dark\" variant=\"dark\" class=\"mb-5\">\r\n      <b-navbar-brand>\r\n        <router-link to=\"/\">Butterfly annotator</router-link>\r\n      </b-navbar-brand>\r\n\r\n      <b-navbar-toggle target=\"nav-collapse\"></b-navbar-toggle>\r\n\r\n      <b-collapse id=\"nav-collapse\" is-nav>\r\n        <b-navbar-nav class=\"ml-auto\">\r\n\r\n          <b-navbar-nav v-show=\"!isLoggedIn\">\r\n            <b-nav-item>\r\n              <router-link to=\"/register\">Register</router-link>\r\n            </b-nav-item>\r\n          </b-navbar-nav>\r\n\r\n          <b-navbar-nav v-show=\"!isLoggedIn\">\r\n            <b-nav-item>\r\n              <router-link to=\"/login\">Login</router-link>\r\n            </b-nav-item>\r\n          </b-navbar-nav>\r\n\r\n          <b-nav-item-dropdown right v-show=\"isLoggedIn\">\r\n            <template #button-content>\r\n              <em>{{ username() }}</em>\r\n            </template>\r\n            <b-dropdown-item @click=\"redirectToProfile()\">Profile</b-dropdown-item>\r\n            <b-dropdown-item @click=\"logout()\">Sign Out</b-dropdown-item>\r\n          </b-nav-item-dropdown>\r\n        </b-navbar-nav>\r\n      </b-collapse>\r\n    </b-navbar>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\nnav li:hover,\r\nnav li.router-link-active,\r\nnav li.router-link-exact-active {\r\n  cursor: pointer;\r\n}\r\n\r\nnav li a, .navbar-brand a {\r\n  text-decoration: none !important;\r\n  color: #fff;\r\n  transition: color 0.2s;\r\n}\r\n\r\n.navbar-brand a:hover {\r\n  color: rgb(211, 211, 211) !important;\r\n}\r\n\r\n.nav-item a {\r\n  transition: color 0.2s;\r\n}\r\n\r\n.nav-item a:hover {\r\n  color: rgb(172, 172, 172) !important;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport handleError from '../errors/handler'\r\n\r\nexport default {\r\n  name: 'Header',\r\n  computed: {\r\n    ...mapGetters({ user: 'currentUser', isLoggedIn: 'isLoggedIn' }),\r\n  },\r\n  methods: {\r\n    ...mapActions({ doLogOut: 'logOut' }),\r\n    logout() {\r\n      const t = this\r\n      this.doLogOut().then(_ => t.$router.push('/login'))\r\n        .catch(e => handleError(this.$bvToast, 'Could not log out', `Cause: ${e.response.data.message}`))\r\n    },\r\n    username() {\r\n      return this.isLoggedIn ? this.user.username : ''\r\n    },\r\n    redirectToProfile() {\r\n      this.$router.push({ path: '/settings' })\r\n    },\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Header.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Header.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Header.vue?vue&type=template&id=50eb5121&\"\nimport script from \"./Header.vue?vue&type=script&lang=js&\"\nexport * from \"./Header.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Header.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('footer',{staticClass:\"small mdb-color pt-4\",attrs:{\"id\":\"footer\"}},[_c('p',{staticClass:\"text-center no-drag\"},[_vm._v(\" 2021 Copyright: butterfly-annotator\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <footer id=\"footer\" class=\"small mdb-color pt-4\">\r\n    <p class=\"text-center no-drag\">&copy; 2021 Copyright: butterfly-annotator</p>\r\n  </footer>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Footer',\r\n}\r\n</script>\r\n\r\n<style>\r\n#footer {\r\n  position: absolute;\r\n  bottom: 0;\r\n  width: 100%;\r\n  height: 2.5rem;\r\n}\r\n\r\n.container {\r\n  padding-bottom: 2.5rem;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Footer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Footer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Footer.vue?vue&type=template&id=2045ac13&\"\nimport script from \"./Footer.vue?vue&type=script&lang=js&\"\nexport * from \"./Footer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Footer.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div id=\"app\">\r\n    <Header/>\r\n    <router-view class=\"container container-fluid\"/>\r\n    <Footer/>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n#app {\r\n  position: relative;\r\n  min-height: 95vh;\r\n}\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Nunito:ital@0;1&display=swap');\r\n\r\n* {\r\n  font-family: 'Nunito', sans-serif !important;\r\n}\r\n\r\na {\r\n  text-decoration: none !important;\r\n}\r\n\r\n.no-drag {\r\n  -webkit-user-drag: none;\r\n  user-select: none;\r\n  -moz-user-select: none;\r\n  -webkit-user-select: none;\r\n  -ms-user-select: none;\r\n}\r\n\r\n.page-title {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.card-hover {\r\n  transition: border-color 0.3s;\r\n}\r\n\r\n.card-hover:hover {\r\n  border-color: gray;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport Header from './components/Header'\r\nimport Footer from './components/Footer'\r\n\r\nexport default {\r\n  components: {\r\n    'Header': Header,\r\n    'Footer': Footer,\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=4815e924&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-container',{on:{\"mousemove\":_vm.trackMouse}},[_c('div',{staticClass:\"helper\"},[_c('b-button',{directives:[{name:\"b-modal\",rawName:\"v-b-modal.help\",modifiers:{\"help\":true}}],staticStyle:{\"border-radius\":\"1rem 1rem 0 0\"}},[_vm._v(\"Help?\")])],1),_c('b-modal',{attrs:{\"id\":\"help\",\"hide-footer\":\"\",\"scrollable\":\"\",\"title\":\"How to annotate images?\"}},[_c('h5',[_vm._v(\"General advice:\")]),_c('ul',[_c('li',[_vm._v(\" When you first arrive here, there will be automatically generated suggestions for you of text bits that you could want to use for your annotations. \")]),_c('li',[_vm._v(\" You can delete bits by clicking the cross in their badge, and add some by selecting the bit of text you want and then pressing the \"),_c('b-badge',[_vm._v(\"Add bit\")]),_vm._v(\" button. \")],1),_c('li',[_vm._v(\" Click points on the canvas to start drawing a polygon. Click the first point you've drawn to finish a polygon. Then, choose one of the bits of text you've chosen to associate it with and create a complete annotation. If you don't want to add it now, you can always press \"),_c('b-badge',[_vm._v(\"Escape\")]),_vm._v(\" or click elsewhere, and come back to the selection menu of the polygon by simply clicking that polygon again. \")],1),_c('li',[_vm._v(\" Don't forget to press \"),_c('b-badge',[_vm._v(\"Save\")]),_vm._v(\" to make your changes effective! \")],1)]),_c('hr'),_c('h5',[_vm._v(\" Basic commands \")]),_c('ul',[_c('li',[_vm._v(\" Press \"),_c('b-badge',[_vm._v(\"Escape\")]),_vm._v(\" to stop your drawing. \")],1),_c('li',[_vm._v(\" Click the last point you've created to remove it. \")]),_c('li',[_c('b-badge',[_vm._v(\"Shift + Click\")]),_vm._v(\" when your cursor is close enough to a polygon to delete it. \")],1),_c('li',[_vm._v(\" Place your cursor over a point of a polygon and start dragging it (hold your mouse's left button) to move it. \")]),_c('li',[_vm._v(\" You can Undo (\"),_c('b-badge',[_vm._v(\"Ctrl + Z\")]),_vm._v(\") and Redo (\"),_c('b-badge',[_vm._v(\"Ctrl + Y\")]),_vm._v(\") the following actions: adding a polygon, removing a polygon, moving a point in a polygon. \")],1)])]),_c('b-row',{staticClass:\"mb-2\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('router-link',{attrs:{\"to\":'/bank/' + _vm.bankId}},[_vm._v(\"Back to bank\")])],1)],1),_c('b-row',{staticClass:\"justify-content-between mb-2\"},[_c('b-col',{attrs:{\"cols\":\"1\"}},[_c('b-button',{attrs:{\"disabled\":!_vm.hasPreviousImage},on:{\"click\":function($event){return _vm.previousImage()}}},[_vm._v(\" Previous \")])],1),_c('b-col',{attrs:{\"cols\":\"1\"}},[_c('b-button',{directives:[{name:\"tippy\",rawName:\"v-tippy\",value:({theme: 'google', arrow: true, arrowType: 'round'}),expression:\"{theme: 'google', arrow: true, arrowType: 'round'}\"}],attrs:{\"content\":\"Save the changes made to the image's annotations.\"},on:{\"click\":function($event){return _vm.saveAnnotations()}}},[_vm._v(\" Save \")])],1),_c('b-col',{attrs:{\"cols\":\"1\"}},[_c('b-button',{attrs:{\"disabled\":!_vm.hasNextImage},on:{\"click\":function($event){return _vm.nextImage()}}},[_vm._v(\" Next \")])],1)],1),_c('b-row',{staticClass:\"justify-content-center mb-2\"},[_c('b-col',{attrs:{\"cols\":\"1\"}},[_c('div',{directives:[{name:\"tippy\",rawName:\"v-tippy\",value:({arrow: true, arrowType: 'round', theme: 'google'}),expression:\"{arrow: true, arrowType: 'round', theme: 'google'}\"}],staticStyle:{\"display\":\"inline-block\"},attrs:{\"content\":_vm.undoDisabled ? 'Nothing to undo!' : 'Undo (Ctrl + Z)'}},[_c('b-button',{attrs:{\"disabled\":_vm.undoDisabled},on:{\"click\":function($event){return _vm.undo()}}},[_c('b-icon-arrow-counterclockwise')],1)],1)]),_c('b-col',{attrs:{\"cols\":\"1\"}},[_c('div',{directives:[{name:\"tippy\",rawName:\"v-tippy\",value:({arrow: true, arrowType: 'round', theme: 'google'}),expression:\"{arrow: true, arrowType: 'round', theme: 'google'}\"}],staticStyle:{\"display\":\"inline-block\"},attrs:{\"content\":_vm.redoDisabled ? 'Nothing to redo!' : 'Redo (Ctrl + Y)'}},[_c('b-button',{attrs:{\"disabled\":_vm.redoDisabled},on:{\"click\":function($event){return _vm.redo()}}},[_c('b-icon-arrow-clockwise')],1)],1)])],1),_c('b-row',{staticClass:\"justify-content-center mb-2\"},[_c('div',{staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"tooltip-content\"}},[(_vm.hasNoDescription)?_c('div',[_c('p',[_vm._v(\"This polygon has no description!\")]),_c('p',[_vm._v(\"Please choose one:\")]),_c('b-form-select',{staticClass:\"mb-2\",attrs:{\"id\":_vm.formDummyId,\"options\":_vm.descriptionOptions(),\"size\":\"sm\"}}),_c('b-button',{attrs:{\"variant\":\"primary\",\"size\":\"sm\",\"onclick\":\"addAnnotation()\",\"disabled\":_vm.descriptionOptions().filter(function (b) { return !b.disabled; }).length === 0}},[_vm._v(\"Add!\")])],1):_c('div',[_c('p',[_vm._v(\"This polygon has a description:\")]),_c('p',[_c('em',[_vm._v(_vm._s(_vm.descriptionOfSelectedPolygon))])]),_c('p',[_vm._v(\"Last editor: \"),_c('em',[_vm._v(_vm._s(_vm.authorOfSelectedPolygon))])])])]),_c('div',{staticStyle:{\"position\":\"absolute !important\"},attrs:{\"id\":\"mouse-position\"}}),_c('div',{attrs:{\"id\":\"canvas\"}})]),_c('b-row',{staticClass:\"mb-2\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('b-card',{on:{\"mouseup\":function($event){return _vm.checkTextSelection()},\"mousedown\":function($event){return _vm.checkTextSelection()}}},[_c('p',{staticStyle:{\"white-space\":\"pre-wrap\",\"margin-bottom\":\"0\"},attrs:{\"id\":\"description\"}},_vm._l((_vm.createChunks()),function(bit){return _c('span',{key:bit.start},[(bit.selected)?_c('description-bit',{attrs:{\"text\":bit.text,\"start-index\":bit.start,\"click-handler\":_vm.handleBitClick,\"author\":bit.author,\"suggested\":bit.suggested}}):_c('span',[_vm._v(_vm._s(bit.text))])],1)}),0)])],1)],1),_c('b-row',[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('b-button',{attrs:{\"disabled\":!_vm.canAddBit},on:{\"click\":function($event){return _vm.addTextBit()}}},[_vm._v(\" Add bit \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-badge',{directives:[{name:\"tippy\",rawName:\"v-tippy\",value:({arrow: true, arrowType: 'round', theme: 'google'}),expression:\"{arrow: true, arrowType: 'round', theme: 'google'}\"}],staticClass:\"no-drag\",attrs:{\"content\":_vm.tooltipContent,\"variant\":_vm.badgeVariant}},[_vm._v(_vm._s(_vm.text)),_c('b-icon-x-circle-fill',{staticClass:\"rem-button\",attrs:{\"size\":\"sm\",\"pill\":\"\"},on:{\"click\":function($event){return _vm.clickHandler(_vm.startIndex)}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <b-badge\r\n    :content=\"tooltipContent\"\r\n    v-tippy=\"{arrow: true, arrowType: 'round', theme: 'google'}\" \r\n    class=\"no-drag\" :variant=\"badgeVariant\">{{ text }}<b-icon-x-circle-fill size=\"sm\" class=\"rem-button\" @click=\"clickHandler(startIndex)\" pill></b-icon-x-circle-fill></b-badge>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'DescriptionBit',\r\n  props: {\r\n    text: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    startIndex: {\r\n      type: Number,\r\n      required: true,\r\n    },\r\n    clickHandler: {\r\n      type: Function,\r\n      required: true,\r\n    },\r\n    author: { // the author of the final annotation (ie with the polygon)\r\n      type: String,\r\n      required: false,\r\n    },\r\n    suggested: {\r\n      type: Boolean,\r\n      required: false,\r\n    }\r\n  },\r\n  computed: {\r\n    badgeVariant() {\r\n      // author is present <=> bit assigned \r\n      if (this.author) {\r\n        return \"primary\"\r\n      }\r\n\r\n      if (this.suggested) {\r\n        return \"secondary\" \r\n      }\r\n\r\n      // not assigned, not suggested\r\n      return \"warning\"\r\n    },\r\n    tooltipContent() {\r\n      if (this.author) {\r\n        return `<em>${this.author}</em> has used this bit of description`\r\n      }\r\n      \r\n      if (this.suggested) {\r\n        return 'This is an automatic suggestion'\r\n      }\r\n\r\n      return 'This description bit is not assigned'\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.rem-button {\r\n  margin-left: 0.2rem;\r\n  cursor: pointer;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DescriptionBit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DescriptionBit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DescriptionBit.vue?vue&type=template&id=52de14c2&scoped=true&\"\nimport script from \"./DescriptionBit.vue?vue&type=script&lang=js&\"\nexport * from \"./DescriptionBit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DescriptionBit.vue?vue&type=style&index=0&id=52de14c2&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"52de14c2\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <b-container @mousemove=\"trackMouse\">\r\n    <div class=\"helper\">\r\n      <b-button v-b-modal.help style=\"border-radius: 1rem 1rem 0 0;\">Help?</b-button>\r\n    </div>\r\n    <b-modal id=\"help\" hide-footer scrollable title=\"How to annotate images?\">\r\n      <h5>General advice:</h5>\r\n      <ul>\r\n        <li>\r\n          When you first arrive here, there will be automatically generated suggestions for you of\r\n          text bits that you could want to use for your annotations.\r\n        </li>\r\n        <li>\r\n          You can delete bits by clicking the cross in their badge, and add some by selecting the bit of\r\n          text you want and then pressing the <b-badge>Add bit</b-badge> button.\r\n        </li>\r\n        <li>\r\n          Click points on the canvas to start drawing a polygon. Click the first point you've drawn\r\n          to finish a polygon. Then, choose one of the bits of text you've chosen to associate it with\r\n          and create a complete annotation. If you don't want to add it now, you can always press <b-badge>Escape</b-badge>\r\n          or click elsewhere, and come back to the selection menu of the polygon by simply clicking that\r\n          polygon again.\r\n        </li>\r\n        <li>\r\n          Don't forget to press <b-badge>Save</b-badge> to make your changes effective!\r\n        </li>\r\n      </ul>\r\n      <hr/>\r\n      <h5>\r\n        Basic commands\r\n      </h5>\r\n      <ul>\r\n        <li>\r\n          Press <b-badge>Escape</b-badge> to stop your drawing.\r\n        </li>\r\n        <li>\r\n          Click the last point you've created to remove it.\r\n        </li>\r\n        <li>\r\n          <b-badge>Shift + Click</b-badge> when your cursor is close enough to a polygon to delete it.\r\n        </li>\r\n        <li>\r\n          Place your cursor over a point of a polygon and start dragging it (hold your mouse's left button) \r\n          to move it.\r\n        </li>\r\n        <li>\r\n          You can Undo (<b-badge>Ctrl + Z</b-badge>) and Redo (<b-badge>Ctrl + Y</b-badge>) the following actions:\r\n          adding a polygon, removing a polygon, moving a point in a polygon.\r\n        </li>\r\n      </ul>\r\n    </b-modal>\r\n    <b-row class=\"mb-2\">\r\n      <b-col cols=\"12\">\r\n        <router-link :to=\"'/bank/' + bankId\">Back to bank</router-link>\r\n      </b-col>\r\n    </b-row>\r\n    <!-- Previous/next image buttons -->\r\n    <b-row class=\"justify-content-between mb-2\">\r\n      <b-col cols=\"1\">\r\n        <b-button @click=\"previousImage()\" :disabled=\"!hasPreviousImage\">\r\n          Previous\r\n        </b-button>\r\n      </b-col>\r\n      <b-col cols=\"1\">\r\n        <b-button\r\n          content=\"Save the changes made to the image's annotations.\"\r\n          v-tippy=\"{theme: 'google', arrow: true, arrowType: 'round'}\"\r\n          @click=\"saveAnnotations()\">\r\n          Save\r\n        </b-button>\r\n      </b-col>\r\n      <b-col cols=\"1\">\r\n        <b-button @click=\"nextImage()\" :disabled=\"!hasNextImage\">\r\n          Next\r\n        </b-button>\r\n      </b-col>\r\n    </b-row>\r\n    <!-- Undo/redo buttons -->\r\n    <b-row class=\"justify-content-center mb-2\">\r\n      <b-col cols=\"1\">\r\n        <div\r\n            style=\"display:inline-block;\" \r\n            :content=\"undoDisabled ? 'Nothing to undo!' : 'Undo (Ctrl + Z)'\"\r\n            v-tippy=\"{arrow: true, arrowType: 'round', theme: 'google'}\">\r\n          <b-button\r\n            :disabled=\"undoDisabled\"\r\n            @click=\"undo()\"><b-icon-arrow-counterclockwise></b-icon-arrow-counterclockwise></b-button>\r\n        </div>\r\n      </b-col>\r\n      <b-col cols=\"1\">\r\n        <div\r\n            style=\"display:inline-block;\" \r\n            :content=\"redoDisabled ? 'Nothing to redo!' : 'Redo (Ctrl + Y)'\"\r\n            v-tippy=\"{arrow: true, arrowType: 'round', theme: 'google'}\">\r\n          <b-button\r\n            :disabled=\"redoDisabled\"\r\n            @click=\"redo()\"><b-icon-arrow-clockwise></b-icon-arrow-clockwise></b-button>\r\n        </div>\r\n      </b-col>\r\n    </b-row>\r\n    <!-- P5 canvas -->\r\n    <b-row class=\"justify-content-center mb-2\">\r\n      <!-- Tooltip content (invisible) -->\r\n      <div id=\"tooltip-content\" style=\"display: none\">\r\n        <div v-if=\"hasNoDescription\">\r\n          <p>This polygon has no description!</p>\r\n          <p>Please choose one:</p>\r\n          <b-form-select :id=\"formDummyId\" :options=\"descriptionOptions()\" size=\"sm\" class=\"mb-2\"></b-form-select>\r\n          <b-button variant=\"primary\" size=\"sm\" onclick=\"addAnnotation()\" :disabled=\"descriptionOptions().filter(b => !b.disabled).length === 0\">Add!</b-button>\r\n        </div>\r\n        <div v-else>\r\n          <p>This polygon has a description:</p>\r\n          <p><em>{{ descriptionOfSelectedPolygon }}</em></p>\r\n          <p>Last editor: <em>{{ authorOfSelectedPolygon }}</em></p>\r\n        </div>\r\n      </div>\r\n      <!-- The div to track the mouse position -->\r\n      <div id=\"mouse-position\" style=\"position: absolute !important\"></div>\r\n      <!-- The canvas itself -->\r\n      <div id=\"canvas\"/>\r\n    </b-row>\r\n    <!-- text selection -->\r\n    <b-row class=\"mb-2\">\r\n      <b-col cols=\"12\">\r\n        <b-card \r\n          @mouseup=\"checkTextSelection()\"\r\n          @mousedown=\"checkTextSelection()\">\r\n          <!-- IMPORTANT: do not mess with the paragraph! leave as is -->\r\n          <p style=\"white-space: pre-wrap; margin-bottom: 0;\"\r\n            id=\"description\">\r\n            <span v-for=\"bit in createChunks()\" v-bind:key=\"bit.start\">\r\n              <description-bit v-if=\"bit.selected\" :text=\"bit.text\" \r\n                :start-index=\"bit.start\" :click-handler=\"handleBitClick\"\r\n                :author=\"bit.author\"\r\n                :suggested=\"bit.suggested\"></description-bit>\r\n              <span v-else>{{ bit.text }}</span>\r\n            </span>\r\n          </p>\r\n        </b-card>\r\n      </b-col>\r\n    </b-row>\r\n    <b-row>\r\n      <b-col cols=\"12\">\r\n        <b-button @click=\"addTextBit()\" :disabled=\"!canAddBit\">\r\n          Add bit\r\n        </b-button>\r\n      </b-col>\r\n    </b-row>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapGetters } from 'vuex'\r\nimport P5 from 'p5'\r\nimport { tippy } from 'vue-tippy'\r\n\r\nimport DescriptionBit from './DescriptionBit'\r\nimport handleError from '../errors/handler'\r\n\r\n/**\r\n * Represents a polygon on the image to annotate.\r\n */\r\nclass Polygon {\r\n  /**\r\n   * @param dots the dots that constitute the polygon\r\n   * @param i its position in the `availablePolygons` array\r\n   */\r\n  constructor(dots, i) {\r\n    this.dots = dots\r\n    this.i = i\r\n  }\r\n}\r\n\r\n/**\r\n * Represents an action that can be done or undone.\r\n */\r\nclass Action {\r\n  /**\r\n   * @param redo a function that performs the action\r\n   * @param undo a function that cancels the action\r\n   */\r\n  constructor(redo, undo) {\r\n    this.redo = redo\r\n    this.undo = undo\r\n  }\r\n}\r\n\r\nclass HistoryNode {\r\n  constructor(next, previous, action) {\r\n    this.next = next\r\n    this.previous = previous\r\n    this.action = action\r\n  }\r\n\r\n  hasNext() {\r\n    return this.next !== null\r\n  }\r\n\r\n  hasPrevious() {\r\n    return this.previous !== null\r\n  }\r\n}\r\n\r\nexport default {\r\n  name: 'AnnotateImage',\r\n  components: {\r\n    DescriptionBit,\r\n  },\r\n  data() {\r\n    return {\r\n      imageData: null,\r\n      availablePolygons: [],\r\n      hasPreviousImage: false,\r\n      hasNextImage: false,\r\n      bankId: -1,\r\n      canAddBit: false,\r\n      selectedBits: [],\r\n      selectedPolygon: -1,\r\n      chunkedDescription: [],\r\n      mousePosX: 0,\r\n      mousePosY: 0,\r\n      previousTippy: null,\r\n      // data for undo/redo history\r\n      firstHistoryNode: null,\r\n      lastHistoryNode: null,\r\n      currentHistoryNode: null, // points to the last action that has been DONE (its change is already effective)\r\n    }\r\n  },\r\n  watch: {\r\n    $route(to, from) {\r\n      // used to remove old canvas\r\n      if (to !== from) {\r\n        const toRemove = document.getElementById('defaultCanvas0')\r\n        if (toRemove) {\r\n          toRemove.parentNode.removeChild(toRemove)\r\n        }\r\n        this.hasNextImage = false\r\n        this.hasPreviousImage = false\r\n        this.availablePolygons = []\r\n        this.selectedBits = []\r\n        this.chunkedDescription = []\r\n        this.canAddBit = false\r\n        this.selectedPolygon = -1\r\n        if (this.previousTippy) {\r\n          this.previousTippy.destroy()\r\n          this.previousTippy = null\r\n        }\r\n        this.firstHistoryNode = null\r\n        this.lastHistoryNode = null\r\n        this.currentHistoryNode = null\r\n        this.initializeAll()\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    ...mapGetters({user: 'currentUser'}),\r\n    redoDisabled() {\r\n      // lastHistoryNode still undefined\r\n      if (!this.lastHistoryNode) {\r\n        return true\r\n      }\r\n      return this.currentHistoryNode.next === this.lastHistoryNode\r\n        || this.lastHistoryNode.previous === this.firstHistoryNode // if no history at all yet\r\n    },\r\n    undoDisabled() {\r\n      if (!this.lastHistoryNode) {\r\n        return true\r\n      }\r\n      return this.currentHistoryNode === this.firstHistoryNode // points to the last action done => none is done\r\n        || this.lastHistoryNode.previous === this.firstHistoryNode // no history at all\r\n    },\r\n    hasNoDescription() {\r\n      return this.selectedPolygon === -1 || !this.availablePolygons[this.selectedPolygon].hasDescription\r\n    },\r\n    descriptionOfSelectedPolygon() {\r\n      if (this.hasNoDescription) {\r\n        return ''\r\n      }\r\n      const search = this.availablePolygons[this.selectedPolygon].i\r\n      const annotation = this.imageData.annotations.find(annotation => annotation.polygon && annotation.polygon.i === search)\r\n      return this.imageData.description.substring(annotation.description.start, annotation.description.end)\r\n    },\r\n    authorOfSelectedPolygon() {\r\n      if (this.hasNoDescription) {\r\n        return ''\r\n      }\r\n      const search = this.availablePolygons[this.selectedPolygon].i\r\n      return this.imageData.annotations.find(annotation => annotation.polygon && annotation.polygon.i === search).author\r\n    },\r\n    formDummyId() {\r\n      return 'XXXXX'\r\n    },\r\n    formActualId() {\r\n      return 'tooltip-selected-description'\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapActions({fetchImageData: 'fetchImageData', sendAnnotations: 'sendAnnotations'}),\r\n    descriptionOptions() {\r\n      const ret = []\r\n      for (let i = 0; i < this.selectedBits.length; ++i) {\r\n        const bit = this.selectedBits[i]\r\n        ret.push({\r\n          value: i, text: this.imageData.description.substring(bit.start, bit.end), disabled: Boolean(bit.annotation),\r\n        })\r\n      }\r\n      return ret\r\n    },\r\n    trackMouse(event) {\r\n      this.mousePosX = event.pageX\r\n      this.mousePosY = event.pageY\r\n    },\r\n    previousImage() {\r\n      const path = '/annotate/' + this.imageData.hasPrevious\r\n      this.$router.push({path})\r\n      this.$router.go()\r\n    },\r\n    nextImage() {\r\n      const path = '/annotate/' + this.imageData.hasNext\r\n      this.$router.push({path})\r\n      this.$router.go()\r\n    },\r\n    addAnnotation() {\r\n      // invalid selection?\r\n      if (this.selectedPolygon === -1 || this.selectedBits.length === 0) {\r\n        return\r\n      }\r\n      const polygon = this.availablePolygons[this.selectedPolygon]\r\n      polygon.hasDescription = true\r\n      const selectedDescription = document.getElementById(this.formActualId).value\r\n      const description = this.selectedBits[selectedDescription]\r\n      const annotation = {\r\n        polygon,\r\n        description,\r\n        author: this.user.username,\r\n      }\r\n      description.annotation = annotation\r\n      // add\r\n      this.imageData.annotations.push(annotation)\r\n      if (this.previousTippy) {\r\n        this.previousTippy.destroy()\r\n        this.previousTippy = null\r\n      }\r\n      this.selectedPolygon = -1\r\n    },\r\n    createTooltip() {\r\n      // position invisible div\r\n      const posDiv = document.getElementById('mouse-position')\r\n      posDiv.style.left = this.mousePosX + 'px'\r\n      posDiv.style.top = this.mousePosY + 'px'\r\n      if (this.previousTippy) {\r\n        this.previousTippy.destroy()\r\n      }\r\n      // prepare content\r\n      const content = document.getElementById('tooltip-content').innerHTML.replace(this.formDummyId, this.formActualId)\r\n      this.previousTippy = tippy('#mouse-position', {\r\n        content,\r\n        interactive: true,\r\n      })[0]\r\n      const t = this\r\n      setTimeout(() => {\r\n        if (t.previousTippy) { \r\n          t.previousTippy.show()\r\n        }\r\n      }, 100) // delay to avoid instant close\r\n      return this.previousTippy\r\n    },\r\n    createChunks() {\r\n      if (!this.imageData) {\r\n        return []\r\n      }\r\n      if (this.selectedBits.length === 0) {\r\n        return [{text: this.imageData.description, selected: false}]\r\n      }\r\n      let ret = []\r\n      let previousEnd = 0\r\n      // the code assumes that the bits are sorted by their beginning index,\r\n      // and that there are no overlaps\r\n      for (let i = 0; i < this.selectedBits.length; ++i) {\r\n        const bit = this.selectedBits[i]\r\n        // add beginning\r\n        // start field for vue keys\r\n        if (bit.start !== previousEnd) {\r\n          ret.push({text: this.imageData.description.substring(previousEnd, bit.start), selected: false, start: previousEnd})\r\n        }\r\n        // add the actual selected bit\r\n        ret.push({\r\n          text: this.imageData.description.substring(bit.start, bit.end), \r\n          selected: true, \r\n          start: bit.start, \r\n          author: bit.annotation ? bit.annotation.author : '',\r\n          suggested: bit.suggested,\r\n        })\r\n        previousEnd = bit.end\r\n      }\r\n      // add remainder, if any\r\n      const last = this.selectedBits[this.selectedBits.length - 1]\r\n      if (last.end !== this.imageData.description.length) {\r\n        ret.push({text: this.imageData.description.substring(last.end), selected: false, start: last.end})\r\n      }\r\n      return ret\r\n    },\r\n    handleBitClick(start) {\r\n      const i = this.selectedBits.findIndex(b => b.start === start)\r\n      if (i === -1) {\r\n        return // (not found)\r\n      }\r\n      this.selectedBits.splice(i, 1)\r\n      // find if annotation assigned\r\n      const annotation = this.imageData.annotations.find(a => a.description.start === start)\r\n      if (annotation) {\r\n        annotation.toRemove = true\r\n        annotation.description = null\r\n        if (annotation.polygon) {\r\n          annotation.polygon.hasDescription = false\r\n        }\r\n      }\r\n    },\r\n    saveAnnotations() {\r\n      // filter the annotations that never were online\r\n      const remPred = a => !(a.toRemove && !a.id)\r\n      const annotations = this.imageData.annotations.filter(remPred).map(annotation => {\r\n        const id = annotation.id ? annotation.id : -1 // new annotation!\r\n        if (annotation.toRemove) {\r\n          return {\r\n            'id': id,\r\n            'rem': true,\r\n          }\r\n        } else {\r\n          return {\r\n            'id': id,\r\n            'points': annotation.polygon.dots.map(p => {\r\n              return {\r\n                x: Math.floor(p.x),\r\n                y: Math.floor(p.y),\r\n              }\r\n            }),\r\n            'tag': {\r\n              'start': annotation.description.start,\r\n              'end': annotation.description.end,\r\n            },\r\n          }\r\n        }\r\n      })\r\n      const t = this\r\n      this.sendAnnotations({\r\n        data: {\r\n          imageId: this.$route.params.imageId,\r\n          annotations,\r\n        },\r\n      }).then(res => {\r\n        t.imageData.annotations = t.imageData.annotations.filter(remPred)\r\n        for (let i = 0; i < t.imageData.annotations.length; ++i) {\r\n          const annot = t.imageData.annotations[i]\r\n          annot.id = res.data.ids[i]\r\n        }\r\n        t.$bvToast.toast('Done.', {\r\n          title: 'Successfully saved annotations!',\r\n          variant: 'success',\r\n          solid: true,\r\n        })\r\n      }).catch(e => handleError(this.$bvToast, 'Could not save annotations', `Cause: ${e.response.data.message}`))\r\n    },\r\n    descriptionIndices(text) {\r\n      const start = this.imageData.description.indexOf(text) // TODO: what if beginning trimmed?\r\n      const end = start + text.trim().length // (exclusive)\r\n      return { start, end }\r\n    },\r\n    checkTextSelection() {\r\n      const selection = window.getSelection()\r\n      const rawText = selection.toString()\r\n      const {start, end} = this.descriptionIndices(rawText)\r\n      // trying to add an overlapping bit!\r\n      if (this.selectedBits.some(bit => start <= bit.end && bit.start <= end)) {\r\n        this.canAddBit = false\r\n        return\r\n      }\r\n      const selectedText = rawText.trim()\r\n      this.canAddBit = !!selectedText // coerce to boolean\r\n    },\r\n    addTextBit() {\r\n      const selection = window.getSelection()\r\n      const rawText = selection.toString()\r\n      const selectedText = rawText.trim()\r\n      if (!selectedText) {\r\n        return\r\n      }\r\n      const {start, end} = this.descriptionIndices(rawText)\r\n      this.selectedBits.push({ start, end })\r\n      this.selectedBits.sort((b, a) => b.start - a.start) // first start first; should be no overlap too\r\n      selection.empty()\r\n      this.canAddBit = false\r\n    },\r\n    undo() {\r\n      if (this.undoDisabled) {\r\n        return\r\n      }\r\n      const current = this.currentHistoryNode\r\n      current.action.undo()\r\n      this.currentHistoryNode = current.previous\r\n    },\r\n    redo() {\r\n      // no history yet!\r\n      if (this.redoDisabled) {\r\n        return\r\n      }\r\n      const current = this.currentHistoryNode\r\n      current.next.action.redo()\r\n      this.currentHistoryNode = current.next\r\n    },\r\n    pushHistory(redo, undo) {\r\n      // continuing history or branching to new history: same handling\r\n      const node = new HistoryNode(this.lastHistoryNode, this.currentHistoryNode, new Action(redo, undo))\r\n      this.currentHistoryNode.next = node\r\n      this.lastHistoryNode.previous = node\r\n      this.currentHistoryNode = node\r\n      redo()\r\n    },\r\n    initializeAll() {\r\n      const t = this\r\n      const script = p5 => {\r\n        // optimizes performance\r\n        p5.disableFriendlyErrors = true\r\n\r\n        /**\r\n         * Draws lines that connect all `(i, i + 1)` dots and closes the shape if `close` is `true`.\r\n         * @param color the color of the lines\r\n         * @param dots the dots to connect\r\n         * @param close whether the last dot should be connected to the first one\r\n         */\r\n        const connectDotsOpen = (color, dots, close) => {\r\n          p5.stroke(color)\r\n          for (let i = 0; i < dots.length - 1; i++) {\r\n            const currentPoint = dots[i]\r\n            const nextPoint = dots[i + 1]\r\n            p5.line(currentPoint.x, currentPoint.y, nextPoint.x, nextPoint.y)\r\n          }\r\n          if (close) {\r\n            // join the first and last points of the polygon\r\n            const first = dots[0]\r\n            const last = dots[dots.length - 1]\r\n            p5.line(last.x, last.y, first.x, first.y)\r\n          }\r\n          p5.noStroke()\r\n          p5.fill(color)\r\n          for (let i = 0; i < dots.length; ++i) {\r\n            const dot = dots[i]\r\n            p5.ellipse(dot.x, dot.y, MOUSE_RAD)\r\n          }\r\n        }\r\n\r\n        // the radius around a point we allow\r\n        const EPS = 15\r\n        // the disk following the mouse\r\n        const MOUSE_RAD = 9\r\n        const MOUSE_STROKE_WEIGHT = 2\r\n        // general stroke weight\r\n        const STROKE_WEIGHT = 4\r\n\r\n        // the key to be pressed to delete a polygon\r\n        const DELETE_KEY = p5.SHIFT\r\n\r\n        // the maximal framerate (setting it to 60 had no effect)\r\n        const MAX_FPS = 50\r\n\r\n        // we will build a color sequence that always assigns the same color to a given index\r\n        // (color(0), color(1), ..., color(n), ...)\r\n        /**\r\n         * @param i the integer representing the polygon in the sequence\r\n         * @returns the color of the `i-th` polygon.\r\n         */\r\n        const colorSequence = i => p5.color((16 * i) % 256, (64 * (i + 1)) % 256, (30 * i) % 256, 150)\r\n\r\n        // returns the closest point constituting a polygon in an `EPS` radius\r\n        // to the mouse\r\n        // TODO: this doesn't return the closest point, it returns the first in radius\r\n        const closestPointInRadius = () => {\r\n          const mousePosition = p5.createVector(p5.mouseX, p5.mouseY)\r\n          for (let i = 0; i < t.availablePolygons.length; ++i) {\r\n            const polygon = t.availablePolygons[i]\r\n            for (let j = 0; j < polygon.dots.length; ++j) {\r\n              const dot = polygon.dots[j]\r\n              if (closeEnough(dot, mousePosition)) {\r\n                return { dot, polygon: i, dotIdx: j }\r\n              }\r\n            }\r\n          }\r\n          return null\r\n        }\r\n\r\n        /**\r\n         * @param search the point\r\n         * @param polygon the polygon\r\n         * @returns {{distance: number, index: number}} where `distance` is the distance\r\n         * to the closest point of the provided polygon and `index` is its index in\r\n         * `availablePolygons`.\r\n         */\r\n        const polygonDistance = (search, polygon) => {\r\n          let distMin = 0\r\n          let argMin = 0\r\n          for (let i = 0; i < polygon.dots.length; ++i) {\r\n            const pointA = polygon.dots[i]\r\n            const pointB = polygon.dots[(i + 1) % polygon.dots.length] // (roll)\r\n            const lineX = pointB.x - pointA.x\r\n            const lineY = pointB.y - pointA.y\r\n            const diffX = search.x - pointA.x\r\n            const diffY = search.y - pointA.y\r\n            const d = diffX * lineX + diffY * lineY\r\n            const r = d / (lineX * lineX + lineY * lineY)\r\n            \r\n            let compX = 0.0\r\n            let compY = 0.0\r\n            if (r < 0) {\r\n              compX = pointA.x\r\n              compY = pointA.y\r\n            } else if (r > 1) {\r\n              compX = pointB.x\r\n              compY = pointB.y\r\n            } else {\r\n              compX = pointA.x + r * lineX\r\n              compY = pointA.y + r * lineY\r\n            }\r\n            const dx = search.x - compX\r\n            const dy = search.y - compY\r\n            const dist = dx * dx + dy * dy\r\n            if (dist < distMin || i === 0) {\r\n              distMin = dist\r\n              argMin = i\r\n            }\r\n          }\r\n          return { distance: distMin, index: argMin }\r\n        }\r\n\r\n        // returns the closest line constituting a polygon in a right angle `EPS` distance\r\n        // to the mouse\r\n        /**\r\n         * @returns {{dotsIdx: number, polygon: number, distance: number}} `dotsIdx`\r\n         * is the index of the first point constituting the line (the next one being\r\n         * `(dotsIdx + 1) % dots.length)`, `polygon` is the position of the polygon in the\r\n         * `availablePolygons` array, and `distance` is the distance of the mouse to that\r\n         * line.\r\n         */\r\n        const closestLineInRadius = () => {\r\n          const mousePosition = p5.createVector(p5.mouseX, p5.mouseY)\r\n          let polygonArgmin = -1\r\n          let dotsArgmin = -1\r\n          let minDist = Number.POSITIVE_INFINITY\r\n          for (let i = 0; i < t.availablePolygons.length; ++i) {\r\n            const polygon = t.availablePolygons[i]\r\n            const {distance, index} = polygonDistance(mousePosition, polygon)\r\n            if (minDist > distance) {\r\n              minDist = distance\r\n              dotsArgmin = index\r\n              polygonArgmin = i\r\n            }\r\n          }\r\n          return {polygon: polygonArgmin, dotsIdx: dotsArgmin, distance: minDist}\r\n        }\r\n\r\n        /**\r\n         * @returns `true` if the user's mouse is within the canvas.\r\n         */\r\n        const mouseInCanvas = () => 0 < p5.mouseX && p5.mouseX < t.imageData.width\r\n            && 0 < p5.mouseY && p5.mouseY < t.imageData.height\r\n\r\n        /**\r\n         * @param u first point\r\n         * @param v second point\r\n         * @returns the squared distance between points `u` and `v`.\r\n         */\r\n        const distanceSquared = (u, v) => {\r\n          const dx = u.x - v.x\r\n          const dy = u.y - v.y\r\n          return dx * dx + dy * dy\r\n        }\r\n\r\n        /**\r\n         * @param a a first point\r\n         * @param b a second point\r\n         * @returns `true` if the two points are close enough to be considered to be\r\n         * in \"approximately\" the same location\r\n         */\r\n        const closeEnough = (a, b) => distanceSquared(a, b) < EPS * EPS\r\n\r\n        /**\r\n         * Displays the provided polygon\r\n         * @param color the color it should take\r\n         * @param polygon the polygon object to draq\r\n         */\r\n        const display = (color, polygon) => connectDotsOpen(color, polygon.dots, true)\r\n\r\n        /**\r\n         * @returns the next index of the polygon\r\n         */\r\n        const nextIndex = () => t.availablePolygons.length > 0 \r\n          ? t.availablePolygons[t.availablePolygons.length - 1].i + 1\r\n          : 0\r\n\r\n        /**\r\n         * Deletes the provided polygon.\r\n         * @param polygon the index of the polygon\r\n         * @param history `true` if this action should be undoable (add it to history)\r\n         */\r\n        const deletePolygon = (polygon, history) => {\r\n          // copy data\r\n          const objPolygon = Object.assign({}, t.availablePolygons[polygon]) // deep copy\r\n          objPolygon.hasDescription = false\r\n          const copySelected = t.selectedPolygon\r\n          const nowAnnot = t.imageData.annotations.find(a => a.polygon && a.polygon.i === polygon)\r\n          if (nowAnnot) {\r\n            const bit = t.selectedBits.find(b => b.annotation === nowAnnot)\r\n            bit.annotation = null\r\n          }\r\n          // delete polygon\r\n          const redo = () => {\r\n            const annot = t.imageData.annotations.findIndex(annotation => annotation.polygon && annotation.polygon.i === objPolygon.i)\r\n            const annotation = annot !== -1 ? t.imageData.annotations[annot] : null\r\n            t.availablePolygons.splice(polygon, 1)\r\n            // check if the `annot`-th annotation has not changed\r\n            if (annotation && t.imageData.annotations.length > annot && t.imageData.annotations[annot] === annotation) {\r\n              // remove the annotation when sending to server\r\n              annotation.toRemove = true\r\n              annotation.polygon = null\r\n              if (annotation.description) {\r\n                annotation.description.annotation = null\r\n              }\r\n            }\r\n            t.selectedPolygon = -1\r\n          }\r\n          // repush polygon\r\n          const undo = () => {\r\n            const annot = t.imageData.annotations.findIndex(annotation => annotation.polygon && annotation.polygon.i === objPolygon.i)\r\n            const annotation = annot !== -1 ? t.imageData.annotations[annot] : null\r\n            // restore only the polygon: lose the annotation\r\n            t.availablePolygons.splice(polygon, 0, objPolygon)\r\n            // same as above\r\n            if (annotation && t.imageData.annotations.length > annot && t.imageData.annotations[annot] === annotation) {\r\n              annotation.toRemove = false\r\n              annotation.polygon = objPolygon\r\n              if (annotation.description) {\r\n                annotation.description.annotation = annotation\r\n              }\r\n            }\r\n            t.selectedPolygon = copySelected\r\n          }\r\n          if (history) {\r\n            t.pushHistory(redo, undo)\r\n          } else {\r\n            redo()\r\n          }\r\n        }\r\n\r\n        // variables\r\n        let currentPoints = []\r\n        let annotateImage = undefined\r\n        let movedPoint = null\r\n        let movedPointOriginalLocation = null\r\n\r\n        // setup the canvas\r\n        p5.setup = () => {\r\n          // canvas\r\n          p5.createCanvas(t.imageData.width, t.imageData.height)\r\n          // using 127.0.0.1 allows for this to work on Chrome (it doesn't like 'localhost')\r\n          annotateImage = p5.loadImage('http://127.0.0.1:' + (process.env.PORT ? process.env.PORT : '5000') + '/api/' + t.imageData.imageUrl)\r\n          // cap framerate\r\n          p5.frameRate(MAX_FPS)\r\n        }\r\n\r\n        p5.draw = () => {\r\n          // display the image to be annotated\r\n          p5.image(annotateImage, 0, 0, t.imageData.width, t.imageData.height)\r\n          // display all polygons\r\n          p5.strokeWeight(STROKE_WEIGHT)\r\n          // currently displacing a point\r\n          if (movedPoint) {\r\n            t.availablePolygons[movedPoint.polygon].dots[movedPoint.dotIdx] = p5.createVector(p5.mouseX, p5.mouseY)\r\n          }\r\n          // draw all existing polygons\r\n          t.availablePolygons.forEach(polygon => display(colorSequence(polygon.i), polygon))\r\n          // draw the current polygon being drawn\r\n          if (currentPoints.length > 0) {\r\n            const color = colorSequence(nextIndex())\r\n            connectDotsOpen(color, currentPoints, false)\r\n            // connect the last point to the mouse's position\r\n            p5.stroke(color)\r\n            const last = currentPoints[currentPoints.length - 1]\r\n            p5.line(last.x, last.y, p5.mouseX, p5.mouseY)\r\n          }\r\n\r\n          // hovering and not drawing? then don't suggest new circle\r\n          const closest = closestLineInRadius()\r\n          if (!closest || closest.distance >= EPS || currentPoints.length > 0) {\r\n            p5.strokeWeight(MOUSE_STROKE_WEIGHT)\r\n            p5.fill(colorSequence(t.availablePolygons.length))\r\n            p5.ellipse(p5.mouseX, p5.mouseY, MOUSE_RAD)\r\n          }\r\n\r\n          // select cursor\r\n          if (p5.keyIsDown(DELETE_KEY)) {\r\n            p5.cursor(p5.HAND)\r\n          } else {\r\n            const closest = closestPointInRadius()\r\n            if (closest) {\r\n              p5.cursor(p5.MOVE)\r\n            } else {\r\n              p5.cursor(p5.ARROW)\r\n            }\r\n          }\r\n        }\r\n\r\n        p5.keyPressed = () => {\r\n          if (p5.keyCode === p5.ESCAPE) {\r\n            // close tooltip and clear current polygon and selection\r\n            if (t.previousTippy) {\r\n              const prev = t.previousTippy\r\n              t.previousTippy = null\r\n              prev.hide()\r\n              setTimeout(() => prev.destroy(), 500)\r\n            }\r\n            t.selectedPolygon = -1\r\n            currentPoints = []\r\n          } else if (p5.keyIsDown(p5.CONTROL)) {\r\n            const UNDO_KEYCODE = 90 // Z\r\n            const REDO_KEYCODE = 89 // Y\r\n            if (p5.keyCode === UNDO_KEYCODE) {\r\n              t.undo()\r\n            } else if (p5.keyCode === REDO_KEYCODE) {\r\n              t.redo()\r\n            }\r\n          }\r\n        }\r\n\r\n        p5.mousePressed = () => {\r\n          if (!mouseInCanvas()) {\r\n            return\r\n          }\r\n\r\n          const closest = closestPointInRadius()\r\n          // no close point, or already creating a polygon\r\n          if (!closest || currentPoints.length > 0) {\r\n            return\r\n          }\r\n\r\n          movedPoint = closest\r\n          // not set yet\r\n          if (!movedPointOriginalLocation) {\r\n            movedPointOriginalLocation = p5.createVector(closest.dot.x, closest.dot.y)\r\n          }\r\n        }\r\n\r\n        p5.mouseReleased = () => {\r\n          if (mouseInCanvas() && (!t.previousTippy || !t.previousTippy.isVisible)) {\r\n            // if the user hasn't started drawing any polygon\r\n            const position = p5.createVector(p5.mouseX, p5.mouseY)\r\n            // was displacing a point\r\n            if (movedPoint) {\r\n              const location = movedPointOriginalLocation\r\n              const point = movedPoint\r\n              const redo = () => {\r\n                t.availablePolygons[point.polygon].dots[point.dotIdx] = position\r\n              }\r\n              const undo = () => {\r\n                t.availablePolygons[point.polygon].dots[point.dotIdx] = location\r\n              }\r\n              movedPointOriginalLocation = null\r\n              movedPoint = null\r\n              t.pushHistory(redo, undo)\r\n              return\r\n            }\r\n            const closest = closestLineInRadius()\r\n            // is deleting a polygon\r\n            if (p5.keyIsDown(DELETE_KEY)) {\r\n              if (closest && closest.distance < EPS * EPS) {\r\n                deletePolygon(closest.polygon, true)\r\n              }\r\n              return\r\n            }\r\n            // clicking on a polygon and not creating a new one\r\n            if (closest.distance < EPS * EPS && currentPoints.length === 0) {\r\n              t.selectedPolygon = closest.polygon\r\n              setTimeout(() => t.createTooltip(), 1)\r\n              return\r\n            }\r\n            // start polygon\r\n            if (currentPoints.length === 0) {\r\n              const closest = closestLineInRadius()\r\n              // clicking existing polygon\r\n              if (closest && closest.distance < EPS * EPS) {\r\n                t.selectedPolygon = closest.polygon\r\n              } else {\r\n                currentPoints.push(position)\r\n              }\r\n              return\r\n            }\r\n            // if the user has only put 1 or 2 points so far\r\n            if (currentPoints.length <= 2) {\r\n              const first = currentPoints[0]\r\n              if (closeEnough(first, position)) {\r\n                currentPoints.pop()\r\n              } else {\r\n                // two points\r\n                if (currentPoints.length === 2) {\r\n                  const second = currentPoints[1]\r\n                  // remove point as usual\r\n                  if (closeEnough(second, position)) {\r\n                    currentPoints.pop()\r\n                  } else {\r\n                    currentPoints.push(position)\r\n                  }\r\n                } else {\r\n                  // only one point => add the new one\r\n                  currentPoints.push(position)\r\n                }\r\n              }\r\n              return\r\n            }\r\n            // two points at least\r\n            // check if closing polygon\r\n            const first = currentPoints[0]\r\n            if (closeEnough(first, position)) {\r\n              const tip = t.createTooltip()\r\n              const index = nextIndex()\r\n              // init polygon\r\n              const poly = new Polygon(currentPoints, index)\r\n              // reset to new selection\r\n              currentPoints = []\r\n              const redo = () => {\r\n                // add a new polygon!\r\n                t.availablePolygons.push(poly)\r\n                t.selectedPolygon = index\r\n                const annot = t.imageData.annotations.find(a => a.polygon && a.polygon.i === poly.i)\r\n                if (annot) {\r\n                  annot.toRemove = false\r\n                  annot.description.annotation = annot\r\n                }\r\n              }\r\n\r\n              const undo = () => {\r\n                // delete tooltip\r\n                if (tip) {\r\n                  tip.destroy()\r\n                }\r\n                // do not restore older points: otherwise the user is going to\r\n                // be editing the polygon he started just before\r\n                deletePolygon(index, false)\r\n              }\r\n              this.pushHistory(redo, undo)\r\n              return\r\n            }\r\n            // check if the user is deleting the previous point\r\n            const last = currentPoints[currentPoints.length - 1]\r\n            if (closeEnough(last, position)) {\r\n              currentPoints.pop() // remove it\r\n              return\r\n            }\r\n            // otherwise, just adding a point\r\n            currentPoints.push(position)\r\n          }\r\n        }\r\n      }\r\n      this.fetchImageData({imageId: this.$route.params.imageId}).then(res => {\r\n        this.imageData = res.data\r\n        this.bankId = this.imageData.bankId\r\n        this.hasNextImage = this.imageData.hasNext !== -1\r\n        this.hasPreviousImage = this.imageData.hasPrevious !== -1\r\n        // add all annotations\r\n        this.imageData.annotations.forEach((annotation, i) => {\r\n          let points = []\r\n          annotation.regionInfo.split(';').forEach(rawPoint => {\r\n            const rawCoord = rawPoint.split(',')\r\n            points.push(new P5.Vector(parseInt(rawCoord[0]), parseInt(rawCoord[1])))\r\n          })\r\n          const polygon = new Polygon(points, i)\r\n          polygon.hasDescription = true\r\n          annotation.polygon = polygon\r\n          this.selectedBits.push({start: annotation.description.start, end: annotation.description.end, annotation})\r\n          this.availablePolygons.push(polygon)\r\n        })\r\n        // no annotations, take suggestions\r\n        if (!this.imageData.annotations || this.imageData.annotations.length === 0) {\r\n          this.imageData.suggestions.forEach(suggestion => {\r\n            this.selectedBits.push({start: suggestion.start, end: suggestion.end, suggested: true})\r\n          })\r\n        }\r\n        this.selectedBits.sort((b, a) => b.start - a.start)\r\n        // finally, load the P5 canvas\r\n        const p5canvas = new P5(script, 'canvas')\r\n      }).catch(e => handleError(this.$bvToast, 'Could not load annotations', `Cause ${e.response.data.message}`))\r\n    },\r\n  },\r\n  mounted() {\r\n    this.initializeAll()\r\n  },\r\n  created() {\r\n    window.addAnnotation = this.addAnnotation\r\n    // setup history nodes\r\n    this.firstHistoryNode = new HistoryNode(null, null)\r\n    this.lastHistoryNode = new HistoryNode(null, this.firstHistoryNode)\r\n    this.firstHistoryNode.next = this.lastHistoryNode\r\n    this.currentHistoryNode = this.firstHistoryNode\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.helper {\r\n  position: fixed;\r\n  bottom: 0;\r\n  right: 0;\r\n  margin-right: 2em;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AnnotateImage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AnnotateImage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AnnotateImage.vue?vue&type=template&id=0fad4d3d&scoped=true&\"\nimport script from \"./AnnotateImage.vue?vue&type=script&lang=js&\"\nexport * from \"./AnnotateImage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AnnotateImage.vue?vue&type=style&index=0&id=0fad4d3d&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0fad4d3d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-container',[_c('h2',{staticClass:\"page-title\"},[_vm._v(\" Bank: \"+_vm._s(_vm.bankName)+\" \"),_c('b-button',{directives:[{name:\"b-modal\",rawName:\"v-b-modal.settings-modal\",modifiers:{\"settings-modal\":true}}],attrs:{\"variant\":\"secondary\"}},[_c('b-icon-gear')],1),_c('b-modal',{attrs:{\"id\":\"settings-modal\",\"title\":\"Settings\",\"hide-footer\":\"\"}},[_c('b-button',{attrs:{\"variant\":\"danger\",\"disabled\":_vm.currentAccess >= 90},on:{\"click\":_vm.deleteBank}},[_vm._v(\" Delete bank \")])],1)],1),_c('b-row',[_c('b-col',[_c('p',[_c('router-link',{attrs:{\"to\":\"/\"}},[_vm._v(\"Return to the list of banks\")])],1)])],1),_c('b-tabs',{attrs:{\"justified\":\"\"},scopedSlots:_vm._u([{key:\"tabs-end\",fn:function(){return [_c('b-nav-item',{attrs:{\"href\":\"#\",\"role\":\"presentation\"},on:{\"click\":function($event){return _vm.downloadJson()}}},[_c('b-icon-download',{staticClass:\"pr-2\"}),_vm._v(\"Export to JSON\")],1)]},proxy:true}])},[_c('b-tab',{attrs:{\"title\":\"Images\",\"active\":\"\"}},[_c('form',[_c('b-row',[_c('b-col',{staticClass:\"mt-2\",attrs:{\"cols\":\"12\"}},[_c('b-input-group',{on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.preventDefault();}}},[_c('b-input-group-prepend',[_c('b-input-group-text',[_c('b-icon-search')],1)],1),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.searchText),expression:\"searchText\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"placeholder\":\"Search...\"},domProps:{\"value\":(_vm.searchText)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.searchText=$event.target.value}}})],1)],1)],1)],1),_c('b-row',_vm._l((_vm.imagesToShow),function(image){return _c('b-col',{key:image.id,attrs:{\"md\":\"4\",\"sm\":\"6\",\"xs\":\"12\"}},[_c('router-link',{attrs:{\"to\":'/annotate/' + image.id}},[_c('b-card',{staticClass:\"card-hover no-drag image-to-annotate fade-in-with-style\",attrs:{\"no-body\":\"\"}},[_c('div',{staticClass:\"image-hover-container\"},[_c('img',{staticClass:\"card-img-top image-hover image-in-place\",attrs:{\"src\":_vm.$hostname + '/api/' + image.url,\"alt\":image.id}}),(Boolean(image.lastEditor))?_c('div',{directives:[{name:\"tippy\",rawName:\"v-tippy\",value:({content: (\"<em>\" + (image.lastEditor.username) + \"</em> last annotated this\"), arrow: true, arrowType: 'round', theme: 'google'}),expression:\"{content: `<em>${image.lastEditor.username}</em> last annotated this`, arrow: true, arrowType: 'round', theme: 'google'}\"}],staticClass:\"last-editor\",style:('background-image: url(' + _vm.$hostname + '/api/profile-picture/' + image.lastEditor.username + ')')}):_vm._e()]),_c('b-card-body',{staticClass:\"row justify-content-between align-items-center\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('b-card-text',[_vm._v(_vm._s(image.fullDescription.substring(0, 120))+\"...\")])],1)],1)],1)],1)],1)}),1)],1),_c('b-tab',{attrs:{\"title\":\"Accesses\"}},[_c('b-row',{attrs:{\"v-show\":_vm.hasPermissionToAdd()}},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('b-button',{directives:[{name:\"b-modal\",rawName:\"v-b-modal.add\",modifiers:{\"add\":true}}],staticClass:\"mb-2 mt-2\",attrs:{\"variant\":\"primary\"}},[_vm._v(\"Add user\")])],1),_c('b-modal',{ref:\"add-modal\",attrs:{\"id\":\"add\",\"title\":\"Add user\",\"hide-footer\":\"\"}},[_c('b-form',{attrs:{\"autocomplete\":\"off\"}},[_c('h4',{staticClass:\"text-center\"},[_vm._v(\"Add a user to this group\")]),_c('b-form-group',{attrs:{\"id\":\"user-add-input\",\"label-for\":\"target-user\"}},[_c('label',[_vm._v(\"Username:\")]),_c('b-form-input',{attrs:{\"id\":\"target-user\",\"name\":\"target-user\"},model:{value:(_vm.targetUser),callback:function ($$v) {_vm.targetUser=$$v},expression:\"targetUser\"}})],1),_c('b-form-group',[_c('b-form-select',{attrs:{\"options\":_vm.permissionOptions},model:{value:(_vm.selectedLevel),callback:function ($$v) {_vm.selectedLevel=$$v},expression:\"selectedLevel\"}})],1),_c('b-button',{on:{\"click\":function($event){return _vm.addUser()}}},[_vm._v(\" Add \")])],1)],1)],1),_vm._l((_vm.userAccesses),function(access){return _c('b-row',{key:access.username,staticClass:\"mb-2 justify-content-center\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('b-card',[_vm._v(\" \"+_vm._s(access.username)+\" \"),_c('permission-badge',{attrs:{\"color-variant\":_vm.levelToVariant(access.level),\"permission-title\":_vm.levelToTitle(access.level)}}),_c('b-button',{staticClass:\"float-right remove-user-button\",attrs:{\"variant\":\"danger\"},on:{\"click\":function($event){return _vm.removeUser(access.username)}}},[_c('b-icon-x-circle')],1)],1)],1)],1)})],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-badge',{attrs:{\"variant\":_vm.colorVariant}},[_vm._v(\" \"+_vm._s(_vm.permissionTitle)+\" \")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <b-badge :variant=\"colorVariant\">\r\n    {{ permissionTitle }}\r\n  </b-badge>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'PermissionBadge',\r\n  props: {\r\n    colorVariant: {\r\n      type: String,\r\n      required: true,\r\n    }, \r\n    permissionTitle: {\r\n      type: String,\r\n      required: true\r\n    },\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PermissionBadge.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PermissionBadge.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PermissionBadge.vue?vue&type=template&id=5d0775e6&\"\nimport script from \"./PermissionBadge.vue?vue&type=script&lang=js&\"\nexport * from \"./PermissionBadge.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <b-container>\r\n    <h2 class=\"page-title\">\r\n      Bank: {{ bankName }}\r\n      <b-button variant=\"secondary\" v-b-modal.settings-modal>\r\n        <b-icon-gear/>\r\n      </b-button>\r\n      <b-modal id=\"settings-modal\" title=\"Settings\" hide-footer>\r\n        <b-button variant=\"danger\" @click=\"deleteBank\" :disabled=\"currentAccess >= 90\">\r\n          Delete bank\r\n        </b-button>\r\n      </b-modal>\r\n    </h2>\r\n    <b-row>\r\n      <b-col>\r\n        <p>\r\n          <router-link to=\"/\">Return to the list of banks</router-link>\r\n        </p>\r\n      </b-col>\r\n    </b-row>\r\n    <b-tabs justified>\r\n      <b-tab title=\"Images\" active>\r\n        <form>\r\n          <b-row>\r\n            <b-col cols=\"12\" class=\"mt-2\">\r\n              <b-input-group @keydown.enter.prevent=\"\">\r\n                <b-input-group-prepend>\r\n                  <b-input-group-text>\r\n                    <b-icon-search></b-icon-search>\r\n                  </b-input-group-text>\r\n                </b-input-group-prepend>\r\n                <input type=\"text\" class=\"form-control\" placeholder=\"Search...\" v-model=\"searchText\"/>\r\n              </b-input-group>\r\n            </b-col>\r\n          </b-row>\r\n        </form>\r\n        <b-row>\r\n          <b-col md=\"4\" sm=\"6\" xs=\"12\" v-for=\"image in imagesToShow\" v-bind:key=\"image.id\">\r\n            <router-link :to=\"'/annotate/' + image.id\">\r\n              <!-- no-body to put custom body -->\r\n              <b-card class=\"card-hover no-drag image-to-annotate fade-in-with-style\" no-body>\r\n                <div class=\"image-hover-container\">\r\n                  <img :src=\"$hostname + '/api/' + image.url\" class=\"card-img-top image-hover image-in-place\"\r\n                       :alt=image.id />\r\n                  <div v-if=\"Boolean(image.lastEditor)\" \r\n                    class=\"last-editor\" \r\n                    :style=\"'background-image: url(' + $hostname + '/api/profile-picture/' + image.lastEditor.username + ')'\"\r\n                    v-tippy=\"{content: `<em>${image.lastEditor.username}</em> last annotated this`, arrow: true, arrowType: 'round', theme: 'google'}\"/>\r\n                </div>\r\n                <b-card-body class=\"row justify-content-between align-items-center\">\r\n                  <b-col cols=\"12\">\r\n                    <b-card-text>{{ image.fullDescription.substring(0, 120) }}...</b-card-text>\r\n                  </b-col>\r\n                </b-card-body>\r\n              </b-card>\r\n            </router-link>\r\n          </b-col>\r\n        </b-row>\r\n      </b-tab>\r\n      <!-- Accesses tab -->\r\n      <b-tab title=\"Accesses\">\r\n        <b-row :v-show=\"hasPermissionToAdd()\">\r\n          <b-col cols=\"12\">\r\n            <b-button v-b-modal.add variant=\"primary\" class=\"mb-2 mt-2\">Add user</b-button>\r\n          </b-col>\r\n\r\n          <b-modal id=\"add\" ref=\"add-modal\" title=\"Add user\" hide-footer>\r\n            <b-form autocomplete=\"off\">\r\n              <h4 class=\"text-center\">Add a user to this group</h4>\r\n              <b-form-group id=\"user-add-input\" label-for=\"target-user\">\r\n                <label>Username:</label>\r\n                <b-form-input id=\"target-user\" name=\"target-user\" v-model=\"targetUser\">\r\n                </b-form-input>\r\n              </b-form-group>\r\n              <b-form-group>\r\n                <b-form-select v-model=\"selectedLevel\" :options=\"permissionOptions\"></b-form-select>\r\n              </b-form-group>\r\n              <b-button @click=\"addUser()\">\r\n                Add\r\n              </b-button>\r\n            </b-form>\r\n          </b-modal>\r\n        </b-row>\r\n        <b-row v-for=\"access in userAccesses\" v-bind:key=\"access.username\" class=\"mb-2 justify-content-center\">\r\n          <b-col cols=\"12\">\r\n            <b-card>\r\n              {{ access.username }}\r\n              <permission-badge :color-variant=\"levelToVariant(access.level)\"\r\n                                :permission-title=\"levelToTitle(access.level)\"></permission-badge>\r\n              <b-button variant=\"danger\" @click=\"removeUser(access.username)\" class=\"float-right remove-user-button\"><b-icon-x-circle></b-icon-x-circle></b-button>\r\n            </b-card>\r\n          </b-col>\r\n        </b-row>\r\n      </b-tab>\r\n      <template #tabs-end>\r\n        <b-nav-item href=\"#\" role=\"presentation\" @click=\"downloadJson()\"><b-icon-download class=\"pr-2\"></b-icon-download>Export to JSON</b-nav-item>\r\n      </template>\r\n    </b-tabs>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions, mapGetters} from 'vuex'\r\nimport PermissionBadge from './PermissionBadge'\r\nimport handleError from '../errors/handler'\r\n\r\nexport default {\r\n  name: 'ImageList',\r\n  components: {\r\n    PermissionBadge\r\n  },\r\n  data() {\r\n    return {\r\n      images: [],\r\n      bankName: '(loading)',\r\n      userAccesses: [],\r\n      currentAccess: null,\r\n      selectedLevel: null,\r\n      permissionOptions: [],\r\n      targetUser: null,\r\n      searchText: '',\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({ userInfo: 'currentUser' }),\r\n    imagesToShow() {\r\n      const search = this.searchText.trim()\r\n      if (search) {\r\n        return this.images.filter(image => image.fullDescription.toLowerCase().includes(search.toLowerCase()))\r\n      } else {\r\n        return this.images\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      listImages: 'listImages',\r\n      listAccesses: 'listAccesses',\r\n      requestPermission: 'requestPermission',\r\n      requestJson: 'requestBankJson',\r\n      requestDeleteBank: 'deleteBank',\r\n    }),\r\n    hasPermissionToAdd() {\r\n      return this.currentAccess ? this.currentAccess >= 70 : false\r\n    },\r\n    levelToTitle(level) {\r\n      if (level === 0) {\r\n        return 'Viewer'\r\n      } else if (level === 50) {\r\n        return 'Editor'\r\n      } else if (level === 70) {\r\n        return 'Moderator'\r\n      } else if (level === 90) {\r\n        return 'Admin'\r\n      } else if (level === 100) {\r\n        return 'Super Admin'\r\n      } else {\r\n        return 'Invalid level'\r\n      }\r\n    },\r\n    levelToVariant(level) {\r\n      if (level === 0) {\r\n        return 'light'\r\n      } else if (level === 50) {\r\n        return 'primary'\r\n      } else if (level === 70) {\r\n        return 'success'\r\n      } else if (level === 90) {\r\n        return 'danger'\r\n      } else if (level === 100) {\r\n        return 'danger'\r\n      } else {\r\n        return 'secondary'\r\n      }\r\n    },\r\n    fetchImageList() {\r\n      this.listImages({bankId: this.$route.params.bankId})\r\n        .then(res => {\r\n          let data = res.data\r\n          this.images = data.images\r\n          this.bankName = data.bankName\r\n        })\r\n        .catch(err => {\r\n          handleError(this.$bvToast, 'Cannot load image list', `Cause ${err.response.data.message}`)\r\n        })\r\n    },\r\n    relistAccesses() {\r\n      this.listAccesses({bankId: this.$route.params.bankId}).then(res => {\r\n        this.userAccesses = res.data.users\r\n        this.userAccesses.sort((b, a) => a.level - b.level)\r\n        for (let i = 0; i < res.data.users.length; ++i) {\r\n          const access = res.data.users[i]\r\n          if (access.username === this.userInfo.username) {\r\n            this.currentAccess = access\r\n            if (this.currentAccess.level >= 70) {\r\n              this.permissionOptions = ['Visitor', 'Editor', 'Moderator']\r\n            }\r\n            if (this.currentAccess.level >= 90) {\r\n              this.permissionOptions.push('Admin')\r\n            }\r\n            break\r\n          }\r\n        }\r\n      }).catch(e => handleError(this.$bvToast, 'Cannot load accesses', `Cause ${e.response.data.message}`))\r\n    },\r\n    addUser() {\r\n      const targetUser = this.targetUser\r\n      let level = null\r\n      if (this.selectedLevel === 'Visitor') {\r\n        level = 0\r\n      } else if (this.selectedLevel === 'Editor') {\r\n        level = 50\r\n      } else if (this.selectedLevel === 'Moderator') {\r\n        level = 70\r\n      } else if (this.selectedLevel === 'Admin') {\r\n        level = 90\r\n      }\r\n      this.$refs['add-modal'].hide()\r\n      const bankId = this.$route.params.bankId\r\n      this.requestPermission({targetUser, level, bankId}).then(_ => {\r\n        this.relistAccesses()\r\n      }).catch(e => handleError(this.$bvToast, 'Cannot add user', `Cause: ${e.response.data.message}`))\r\n    },\r\n    removeUser(username) {\r\n      const targetUser = username\r\n      const level = -1\r\n      const bankId = this.$route.params.bankId\r\n      this.requestPermission({targetUser, level, bankId}).then(_ => {\r\n        this.relistAccesses()\r\n      }).catch(e => handleError(this.$bvToast, 'Cannot remove user', `Cause: ${e.response.data.message}`))\r\n    },\r\n    downloadJson() {\r\n      this.requestJson({bankId: this.$route.params.bankId}).then(res => {\r\n        const blob = new Blob([JSON.stringify(res.data, null, 2)], { type: 'application/json' })\r\n        const a = document.createElement('a')\r\n        a.href = URL.createObjectURL(blob)\r\n        a.download = 'bank.json'\r\n        a.click()\r\n        URL.revokeObjectURL(a.href)\r\n      })\r\n    },\r\n    deleteBank() {\r\n      this.requestDeleteBank({bankId: this.$route.params.bankId}).then(res => {\r\n        this.$router.push({'path': '/'})\r\n        this.$bvToast.toast('Successfully deleted bank', {\r\n          title: 'Deleted ' + this.bankName,\r\n          variant: 'success',\r\n          solid: true,\r\n        })\r\n      }).catch(e => handleError(this.$bvToast, 'Could not delete bank', `Cause: ${e.response.data.message}`))\r\n    },\r\n  },\r\n  created() {\r\n    this.fetchImageList()\r\n    this.relistAccesses()\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n.image-in-place {\r\n  object-fit: cover;\r\n  max-width:100%;\r\n  max-height:100%;\r\n  z-index: -1;\r\n}\r\n\r\n.image-hover-container {\r\n  position: relative;\r\n  overflow: hidden;\r\n  height: 12em;\r\n}\r\n\r\n.image-hover {\r\n  transform: scale(1.0);\r\n  transform-origin: center;\r\n  transition: 400ms transform;\r\n}\r\n\r\n.image-hover:hover {\r\n  transform: scale(1.2);\r\n  transform-origin: center;\r\n}\r\n\r\n.image-to-annotate {\r\n  margin-top: 1em;\r\n  margin-bottom: 1em;\r\n}\r\n\r\n.remove-user-button {\r\n  padding-bottom: 0.2rem;\r\n  padding-top: 0.2rem;\r\n  padding-left: 0.3rem;\r\n  padding-right: 0.3rem;\r\n}\r\n\r\n.last-editor {\r\n  position: absolute;\r\n  z-index: 3;\r\n  right: 0;\r\n  bottom: 0;\r\n  width: 3em;\r\n  height: 3em;\r\n  border-radius: 100%;\r\n  background-position: center;\r\n  background-size: cover;\r\n  margin: 1em;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ImageList.vue?vue&type=template&id=35e05470&scoped=true&\"\nimport script from \"./ImageList.vue?vue&type=script&lang=js&\"\nexport * from \"./ImageList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ImageList.vue?vue&type=style&index=0&id=35e05470&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"35e05470\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"row justify-content-center align-items-center\",attrs:{\"id\":\"login-row\"}},[_c('div',{staticClass:\"col-md-6\",attrs:{\"id\":\"login-column\"}},[_c('div',{staticClass:\"col-md-12\",attrs:{\"id\":\"login-box\"}},[_c('b-form',{attrs:{\"autocomplete\":\"off\"}},[_c('h3',{staticClass:\"text-center\"},[_vm._v(\"Login\")]),_c('b-form-group',{attrs:{\"id\":\"input-group-1\",\"label-for\":\"username\"}},[_c('label',[_vm._v(\"Username:\")]),_c('b-form-input',{directives:[{name:\"validate\",rawName:\"v-validate\",value:('required'),expression:\"'required'\"}],attrs:{\"id\":\"username\",\"name\":\"username\",\"state\":_vm.validateState('username')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.submitForm()}},model:{value:(_vm.form.username),callback:function ($$v) {_vm.$set(_vm.form, \"username\", $$v)},expression:\"form.username\"}}),_c('b-form-invalid-feedback',{attrs:{\"id\":\"username\"}},[_vm._v(_vm._s(_vm.veeErrors.first('username')))])],1),_c('b-form-group',{attrs:{\"id\":\"input-group-2\",\"label-for\":\"password\"}},[_c('label',[_vm._v(\"Password:\")]),_c('b-form-input',{directives:[{name:\"validate\",rawName:\"v-validate\",value:('required'),expression:\"'required'\"}],attrs:{\"id\":\"password\",\"name\":\"password\",\"type\":\"password\",\"state\":_vm.validateState('password')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.submitForm()}},model:{value:(_vm.form.password),callback:function ($$v) {_vm.$set(_vm.form, \"password\", $$v)},expression:\"form.password\"}}),_c('b-form-invalid-feedback',{attrs:{\"id\":\"password\"}},[_vm._v(_vm._s(_vm.veeErrors.first('password'))+\" \")])],1),_c('b-button',{staticClass:\"btn-md\",attrs:{\"variant\":\"dark\"},on:{\"click\":function($event){return _vm.submitForm()}}},[_vm._v(\"Sign in \")])],1),_c('div',{staticClass:\"text-left\",staticStyle:{\"margin-top\":\"1em\"}},[_c('router-link',{attrs:{\"to\":\"/register\"}},[_vm._v(\"Need an account?\")])],1)],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div id=\"login-row\" class=\"row justify-content-center align-items-center\">\r\n      <div id=\"login-column\" class=\"col-md-6\">\r\n        <div id=\"login-box\" class=\"col-md-12\">\r\n          <b-form autocomplete=\"off\">\r\n            <h3 class=\"text-center\">Login</h3>\r\n            <b-form-group\r\n                id=\"input-group-1\"\r\n                label-for=\"username\">\r\n              <label>Username:</label>\r\n              <b-form-input\r\n                  id=\"username\"\r\n                  name=\"username\"\r\n                  v-model=\"form.username\"\r\n                  v-validate=\"'required'\"\r\n                  :state=\"validateState('username')\"\r\n                  v-on:keyup.enter=\"submitForm()\"\r\n              ></b-form-input>\r\n              <b-form-invalid-feedback id=\"username\">{{ veeErrors.first('username') }}</b-form-invalid-feedback>\r\n            </b-form-group>\r\n\r\n            <b-form-group\r\n                id=\"input-group-2\"\r\n                label-for=\"password\">\r\n              <label>Password:</label>\r\n              <b-form-input\r\n                  id=\"password\"\r\n                  name=\"password\"\r\n                  v-model=\"form.password\"\r\n                  type=\"password\"\r\n                  v-validate=\"'required'\"\r\n                  :state=\"validateState('password')\"\r\n                  v-on:keyup.enter=\"submitForm()\"\r\n              ></b-form-input>\r\n              <b-form-invalid-feedback id=\"password\">{{\r\n                  veeErrors.first('password')\r\n                }}\r\n              </b-form-invalid-feedback>\r\n            </b-form-group>\r\n\r\n            <b-button\r\n                class=\"btn-md\"\r\n                variant=\"dark\"\r\n                @click=\"submitForm()\">Sign in\r\n            </b-button>\r\n          </b-form>\r\n          <div class=\"text-left\" style=\"margin-top: 1em;\">\r\n            <router-link to=\"/register\">Need an account?</router-link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions, mapGetters} from 'vuex'\r\nimport handleError from '../errors/handler'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      form: {\r\n        username: '',\r\n        password: '',\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({isLoggedIn: 'isLoggedIn'}),\r\n  },\r\n  methods: {\r\n    ...mapActions({ logIn: 'logIn' }),\r\n    validateState(ref) {\r\n      if (\r\n          this.veeFields[ref] &&\r\n          (this.veeFields[ref].dirty || this.veeFields[ref].validated)\r\n      ) {\r\n        return !this.veeErrors.has(ref)\r\n      }\r\n      return null\r\n    },\r\n    submitForm() {\r\n      const t = this\r\n      const formData = this.form\r\n      this.$validator.validateAll().then(valid => {\r\n        if (valid) {\r\n          this.logIn({formData}).then(_ => {\r\n            t.$router.push({ path: '/' })\r\n          }).catch(e => {\r\n            handleError(this.$bvToast, 'Error: could not login', `Cause: ${e.response.data.message}`)\r\n          })\r\n        }\r\n      })\r\n    },\r\n  },\r\n  created() {\r\n    if (this.isLoggedIn) {\r\n      this.$router.push({path: '/'})\r\n    }\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=302392cc&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"row justify-content-center align-items-center\",attrs:{\"id\":\"login-row\"}},[_c('div',{staticClass:\"col-md-6\",attrs:{\"id\":\"login-column\"}},[_c('div',{staticClass:\"col-md-12\",attrs:{\"id\":\"login-box\"}},[_c('b-form',{ref:\"registrationForm\",attrs:{\"model\":_vm.registrationForm,\"autocomplete\":\"off\"}},[_c('h3',{staticClass:\"text-center \"},[_vm._v(\"Register\")]),_c('b-form-group',{staticClass:\"form-group\",attrs:{\"id\":\"input-group-1\",\"label-for\":\"username\"}},[_c('label',{},[_vm._v(\"Username:\")]),_c('br'),_c('b-form-input',{directives:[{name:\"validate\",rawName:\"v-validate\",value:({ required: true }),expression:\"{ required: true }\"}],staticClass:\"form-control\",attrs:{\"id\":\"username\",\"name\":\"username\",\"state\":_vm.validateState('username')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.submitForm()}},model:{value:(_vm.registrationForm.username),callback:function ($$v) {_vm.$set(_vm.registrationForm, \"username\", $$v)},expression:\"registrationForm.username\"}}),_c('b-form-invalid-feedback',{attrs:{\"id\":\"username\"}},[_vm._v(_vm._s(_vm.veeErrors.first('username'))+\" \")])],1),_c('b-form-group',{attrs:{\"id\":\"input-group-2\",\"label-for\":\"password\"}},[_c('label',{},[_vm._v(\"Password:\")]),_c('br'),_c('b-form-input',{directives:[{name:\"validate\",rawName:\"v-validate\",value:({ required: true }),expression:\"{ required: true }\"}],ref:\"password\",attrs:{\"id\":\"password\",\"name\":\"password\",\"type\":\"password\",\"state\":_vm.validateState('password')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.submitForm()}},model:{value:(_vm.registrationForm.password),callback:function ($$v) {_vm.$set(_vm.registrationForm, \"password\", $$v)},expression:\"registrationForm.password\"}}),_c('b-form-invalid-feedback',{attrs:{\"id\":\"password\"}},[_vm._v(_vm._s(_vm.veeErrors.first('password'))+\" \")])],1),_c('b-form-group',{attrs:{\"id\":\"input-group-3\",\"label-for\":\"confirmedPassword\"}},[_c('label',{},[_vm._v(\"Confirm your password:\")]),_c('br'),_c('b-form-input',{directives:[{name:\"validate\",rawName:\"v-validate\",value:('required|confirmed:password'),expression:\"'required|confirmed:password'\"}],attrs:{\"id\":\"confirmedPassword\",\"name\":\"confirmedPassword\",\"type\":\"password\",\"state\":_vm.validateState('confirmedPassword')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.submitForm()}},model:{value:(_vm.registrationForm.confirmedPassword),callback:function ($$v) {_vm.$set(_vm.registrationForm, \"confirmedPassword\", $$v)},expression:\"registrationForm.confirmedPassword\"}}),_c('b-form-invalid-feedback',{attrs:{\"id\":\"confirmedPassword\"}},[_vm._v(_vm._s(_vm.veeErrors.first('confirmedPassword'))+\" \")])],1),_c('b-form-group',{attrs:{\"id\":\"input-group-4\",\"label-for\":\"email\"}},[_c('label',[_vm._v(\"Email:\")]),_c('br'),_c('b-form-input',{directives:[{name:\"validate\",rawName:\"v-validate\",value:({ required: true, email: true }),expression:\"{ required: true, email: true }\"}],attrs:{\"id\":\"email\",\"name\":\"email\",\"type\":\"email\",\"state\":_vm.validateState('email')},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.submitForm()}},model:{value:(_vm.registrationForm.email),callback:function ($$v) {_vm.$set(_vm.registrationForm, \"email\", $$v)},expression:\"registrationForm.email\"}}),_c('b-form-invalid-feedback',{attrs:{\"id\":\"email\"}},[_vm._v(_vm._s(_vm.veeErrors.first('email'))+\" \")])],1),_c('b-button',{staticClass:\"btn-md\",attrs:{\"variant\":\"dark\"},on:{\"click\":function($event){return _vm.submitForm()}}},[_vm._v(\"Register\")])],1),_c('br'),_c('div',{staticClass:\"text-left\"},[_c('router-link',{attrs:{\"to\":\"/login\"}},[_vm._v(\"Already have an account?\")])],1)],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div id=\"login-row\" class=\"row justify-content-center align-items-center\">\r\n      <div id=\"login-column\" class=\"col-md-6\">\r\n        <div id=\"login-box\" class=\"col-md-12\">\r\n          <b-form :model=\"registrationForm\" ref=\"registrationForm\" autocomplete=\"off\">\r\n            <h3 class=\"text-center \">Register</h3>\r\n            <b-form-group\r\n                class=\"form-group\"\r\n                id=\"input-group-1\"\r\n                label-for=\"username\">\r\n              <label class=\"\">Username:</label><br/>\r\n              <b-form-input\r\n                  class=\"form-control\"\r\n                  id=\"username\"\r\n                  name=\"username\"\r\n                  v-model=\"registrationForm.username\"\r\n                  v-validate=\"{ required: true }\"\r\n                  :state=\"validateState('username')\"\r\n                  v-on:keyup.enter=\"submitForm()\"></b-form-input>\r\n              <b-form-invalid-feedback id=\"username\">{{\r\n                  veeErrors.first('username')\r\n                }}\r\n              </b-form-invalid-feedback>\r\n            </b-form-group>\r\n\r\n            <b-form-group\r\n                id=\"input-group-2\"\r\n                label-for=\"password\">\r\n              <label class=\"\">Password:</label><br/>\r\n              <b-form-input\r\n                  id=\"password\"\r\n                  name=\"password\"\r\n                  ref=\"password\"\r\n                  v-model=\"registrationForm.password\"\r\n                  type=\"password\"\r\n                  v-validate=\"{ required: true }\"\r\n                  :state=\"validateState('password')\"\r\n                  v-on:keyup.enter=\"submitForm()\"\r\n              ></b-form-input>\r\n              <b-form-invalid-feedback id=\"password\">{{\r\n                  veeErrors.first('password')\r\n                }}\r\n              </b-form-invalid-feedback>\r\n            </b-form-group>\r\n\r\n            <b-form-group\r\n                id=\"input-group-3\"\r\n                label-for=\"confirmedPassword\">\r\n              <label class=\"\">Confirm your password:</label><br/>\r\n              <b-form-input\r\n                  id=\"confirmedPassword\"\r\n                  name=\"confirmedPassword\"\r\n                  v-model=\"registrationForm.confirmedPassword\"\r\n                  type=\"password\"\r\n                  v-validate=\"'required|confirmed:password'\"\r\n                  :state=\"validateState('confirmedPassword')\"\r\n                  v-on:keyup.enter=\"submitForm()\"></b-form-input>\r\n              <b-form-invalid-feedback id=\"confirmedPassword\">{{\r\n                  veeErrors.first('confirmedPassword')\r\n                }}\r\n              </b-form-invalid-feedback>\r\n            </b-form-group>\r\n\r\n            <b-form-group id=\"input-group-4\" label-for=\"email\">\r\n              <label>Email:</label><br/>\r\n              <b-form-input\r\n                  id=\"email\"\r\n                  name=\"email\"\r\n                  v-model=\"registrationForm.email\"\r\n                  type=\"email\"\r\n                  v-validate=\"{ required: true, email: true }\"\r\n                  :state=\"validateState('email')\"\r\n                  v-on:keyup.enter=\"submitForm()\"></b-form-input>\r\n              <b-form-invalid-feedback id=\"email\">{{\r\n                  veeErrors.first('email')\r\n                }}\r\n              </b-form-invalid-feedback>\r\n            </b-form-group>\r\n\r\n            <b-button\r\n                class=\"btn-md\"\r\n                variant=\"dark\"\r\n                @click=\"submitForm()\">Register</b-button>\r\n          </b-form>\r\n          <br/>\r\n          <div class=\"text-left\">\r\n            <router-link to=\"/login\" class=\"\">Already have an account?</router-link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions} from 'vuex'\r\nimport handleError from '../errors/handler'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      registrationForm: {\r\n        username: '',\r\n        password: '',\r\n        confirmedPassword: '',\r\n        email: '',\r\n      },\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions({register: 'registerAccount'}),\r\n    validateState(ref) {\r\n      if (\r\n          this.veeFields[ref] &&\r\n          (this.veeFields[ref].dirty || this.veeFields[ref].validated)\r\n      ) {\r\n        return !this.veeErrors.has(ref)\r\n      }\r\n      return null\r\n    },\r\n    submitForm() {\r\n      const t = this\r\n      this.$validator.validateAll().then((valid) => {\r\n        if (valid) {\r\n          const registrationForm = this.registrationForm\r\n          this.register({registrationForm}).then(_ => t.$router.push('/'))\r\n              .catch(e => handleError(this.$bvToast, 'Cannot register',\r\n                  `Cause ${e.response.data.message}`))\r\n        }\r\n      })\r\n    },\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Register.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Register.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Register.vue?vue&type=template&id=9a75c4ca&\"\nimport script from \"./Register.vue?vue&type=script&lang=js&\"\nexport * from \"./Register.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-container',{on:{\"dragover\":function($event){$event.preventDefault();return _vm.beginDrag.apply(null, arguments)}}},[_c('b-row',{staticClass:\"justify-content-center\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('h2',{staticClass:\"page-title\"},[_vm._v(\" Your banks \"),_c('b-button',{directives:[{name:\"tippy\",rawName:\"v-tippy\",value:({arrow: true, arrowType: 'round', theme: 'google'}),expression:\"{arrow: true, arrowType: 'round', theme: 'google'}\"}],staticClass:\"upload-button\",attrs:{\"variant\":\"outline-primary\",\"content\":\"You can also drag and drop archives to this page to upload them!\"},on:{\"click\":function($event){_vm.showUpload = true}}},[_c('b-icon-cloud-upload')],1)],1)])],1),_c('div',{staticClass:\"bank-list\"},_vm._l((_vm.availableBanks),function(bank){return _c('b-row',{key:bank.id,staticClass:\"justify-content-center\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('router-link',{attrs:{\"to\":'/bank/' + bank.id}},[_c('b-card',{staticClass:\"card-hover bank-list-card\"},[_c('b-card-title',[_vm._v(\" \"+_vm._s(bank.name)+\" \")]),_c('b-card-text',{staticClass:\"text-muted\"},[_vm._v(\" \"+_vm._s(bank.description)+\" \")])],1)],1)],1)],1)}),1),_c('div',{class:'upload-section' + (_vm.showUpload ? ' upload-section-shown' : ''),on:{\"dragleave\":_vm.stopDrag}},[_c('div',{class:'upload-shadow' + (_vm.showUpload ? ' upload-shadow-shown' : '')}),_c('div',{staticClass:\"upload-modal\",on:{\"drop\":_vm.chooseFile}},[_c('b-container',{attrs:{\"fluid\":\"\"}},[_c('b-row',{staticClass:\"justify-content-end\",staticStyle:{\"margin-bottom\":\"1em\"}},[_c('b-col',{attrs:{\"cols\":\"1\"}},[_c('b-button',{attrs:{\"variant\":\"outline-secondary\"},on:{\"click\":function($event){_vm.showUpload = false}}},[_c('b-icon-x-circle')],1)],1)],1),_c('b-row',{staticClass:\"justify-content-center\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[(_vm.bankFile === null)?_c('div',{staticClass:\"upload-input\"},[_c('input',{ref:\"hidden-upload\",staticClass:\"hidden-upload\",attrs:{\"type\":\"file\",\"accept\":\".zip\",\"id\":\"file-upload\"},on:{\"change\":_vm.checkFiles}}),_c('b-button',{staticClass:\"cloud-upload-button\",attrs:{\"variant\":\"primary\"},on:{\"click\":function($event){return _vm.$refs['hidden-upload'].click()}}},[_c('b-icon-file-earmark-arrow-up')],1),_c('p',{staticClass:\"no-drag suggest-drag-text\"},[_vm._v(\"Drop your zip file containing your bank\")])],1):_c('div',{staticClass:\"upload-input\"},[_c('p',[_vm._v(\"You chose the file \"+_vm._s(_vm.bankFile.name)+\". \"),_c('br'),_c('a',{staticStyle:{\"font-size\":\"80%\"},attrs:{\"href\":\"javascript:void(0)\"},on:{\"click\":_vm.clearSelection}},[_vm._v(\"Clear selection\")])]),_c('b-button',{staticClass:\"cloud-upload-button\",staticStyle:{\"font-size\":\"1em\"},attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.uploadBank}},[_vm._v(\"Upload\")])],1)])],1)],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <b-container @dragover.prevent=\"beginDrag\">\r\n    <b-row class=\"justify-content-center\">\r\n      <b-col cols=\"12\">\r\n        <h2 class=\"page-title\">\r\n          Your banks\r\n          <b-button \r\n            @click=\"showUpload = true\"\r\n            class=\"upload-button\" \r\n            variant=\"outline-primary\"\r\n            v-tippy=\"{arrow: true, arrowType: 'round', theme: 'google'}\"\r\n            content=\"You can also drag and drop archives to this page to upload them!\">\r\n            <b-icon-cloud-upload/>\r\n          </b-button>\r\n        </h2>\r\n      </b-col>\r\n    </b-row>\r\n    <div class=\"bank-list\">\r\n      <b-row class=\"justify-content-center\" v-for=\"bank in availableBanks\" v-bind:key=\"bank.id\">\r\n        <b-col cols=\"12\">\r\n          <router-link :to=\"'/bank/' + bank.id\">\r\n            <b-card class=\"card-hover bank-list-card\">\r\n              <b-card-title>\r\n                {{ bank.name }}\r\n              </b-card-title>\r\n              <b-card-text class=\"text-muted\">\r\n                {{ bank.description }}\r\n              </b-card-text>\r\n            </b-card>\r\n          </router-link>\r\n        </b-col>\r\n      </b-row>\r\n    </div>\r\n    <div :class=\"'upload-section' + (showUpload ? ' upload-section-shown' : '')\" @dragleave=\"stopDrag\">\r\n      <!-- Hover shadow -->\r\n      <div :class=\"'upload-shadow' + (showUpload ? ' upload-shadow-shown' : '')\">\r\n      </div>\r\n      <!-- The content itself -->\r\n      <div class=\"upload-modal\" @drop=\"chooseFile\">\r\n        <b-container fluid>\r\n          <b-row class=\"justify-content-end\" style=\"margin-bottom: 1em;\">\r\n            <b-col cols=\"1\">\r\n              <!-- 'Close' button -->\r\n              <b-button variant=\"outline-secondary\" @click=\"showUpload = false\"><b-icon-x-circle/></b-button>\r\n            </b-col>\r\n          </b-row>\r\n          <b-row class=\"justify-content-center\">\r\n            <b-col cols=\"12\">\r\n              <div class=\"upload-input\" v-if=\"bankFile === null\">\r\n                <!-- Fake file input to trigger browsing -->\r\n                <input type=\"file\" accept=\".zip\" id=\"file-upload\" class=\"hidden-upload\" ref=\"hidden-upload\" @change=\"checkFiles\">\r\n                <b-button @click=\"$refs['hidden-upload'].click()\" variant=\"primary\" class=\"cloud-upload-button\">\r\n                  <b-icon-file-earmark-arrow-up/>\r\n                </b-button>\r\n                <p class=\"no-drag suggest-drag-text\">Drop your zip file containing your bank</p>\r\n              </div>\r\n              <div class=\"upload-input\" v-else>\r\n                <p>You chose the file {{ bankFile.name }}.\r\n                <br><a href=\"javascript:void(0)\" style=\"font-size: 80%;\" @click=\"clearSelection\">Clear selection</a></p>\r\n                <b-button variant=\"primary\" class=\"cloud-upload-button\" style=\"font-size: 1em;\" @click=\"uploadBank\">Upload</b-button>\r\n              </div>\r\n            </b-col>\r\n          </b-row>\r\n        </b-container>\r\n      </div>\r\n    </div>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions} from 'vuex'\r\nimport handleError from '../errors/handler'\r\n\r\nexport default {\r\n  name: 'BankList',\r\n  data() {\r\n    return {\r\n      availableBanks: [],\r\n      showUpload: false,\r\n      bankFile: null,\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions({listBanks: 'listBanks', uploadBankRemote: 'uploadBank'}),\r\n    updateBanks() {\r\n      this.listBanks().then(req => this.availableBanks = req.data)\r\n          .catch(err => handleError(this.$bvToast, 'Cannot list banks',\r\n              `Cause: ${err.response.data.message}`))\r\n    },\r\n    beginDrag(e) {\r\n      e.stopPropagation()\r\n      const transfer = e.dataTransfer\r\n      this.showUpload = transfer.types && transfer.types.indexOf && transfer.types.indexOf('Files') !== -1\r\n      e.dataTransfer.effectAllowed = 'all'\r\n      e.dataTransfer.dropEffect = 'all'\r\n    },\r\n    stopDrag(e) {\r\n      this.showUpload = false\r\n    },\r\n    chooseFile(e) {\r\n      e.preventDefault()\r\n      const files = e.dataTransfer.files\r\n      // no files or not a zip archive\r\n      if (files.length === 0 || !files[0].name.endsWith('.zip')) {\r\n        return\r\n      }\r\n      // accept the file\r\n      this.bankFile = files[0]\r\n    },\r\n    checkFiles(e) {\r\n      if (this.$refs['hidden-upload'].files.length < 1) {\r\n        return\r\n      }\r\n      const file = this.$refs['hidden-upload'].files[0]\r\n      this.bankFile = file  \r\n    },\r\n    clearSelection() {\r\n      this.bankFile = null\r\n    },\r\n    uploadBank() {\r\n      if (this.bankFile === null) {\r\n        handleError(this.$bvToast, 'Cannot upload file', 'No file has been selected.')\r\n        return\r\n      }\r\n      \r\n      const formData = new FormData()\r\n      formData.append('file', this.bankFile)\r\n      this.uploadBankRemote({formData}).then(res => {\r\n        this.$bvToast.toast(res.data.message, {\r\n          title: 'Successfully uploaded bank!',\r\n          variant: 'success',\r\n          solid: true,\r\n        })\r\n        this.showUpload = false\r\n        this.updateBanks()\r\n      }).catch(e => handleError(this.$bvToast, 'Could not upload bank', `Cause: ${e.response.data.message}`))\r\n    },\r\n  },\r\n  created() {\r\n    this.updateBanks()\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n.bank-list-card {\r\n  margin-top: 0.5rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.upload-button {\r\n  margin-left: 1em;\r\n}\r\n\r\n.upload-section {\r\n  height: 100vh;\r\n  width: 100%;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  visibility: hidden;\r\n}\r\n\r\n.upload-shadow-shown {\r\n  opacity: 0.65 !important;\r\n  transition: 200ms opacity;\r\n}\r\n\r\n.upload-section-shown {\r\n  visibility: initial !important;\r\n}\r\n\r\n.upload-shadow {\r\n  height: 100vh;\r\n  width: 100%;\r\n  background-color: rgb(0, 0, 0);\r\n  opacity: 0;\r\n  position: fixed;\r\n}\r\n\r\n.upload-modal {\r\n  position: relative;\r\n  width: 75%;\r\n  border-radius: 1rem;\r\n  background-color: white;\r\n  margin: 5em;\r\n  padding: 1em 1em 1.5em 1em;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n}\r\n\r\n.hidden-upload {\r\n  display: none;\r\n}\r\n\r\n.upload-input {\r\n  border-style: dashed;\r\n  border-color: rgba(0, 0, 0, 0.3);\r\n  width: 100%;\r\n  height: 10em;\r\n  text-align: center;\r\n  padding-top: 2em;\r\n}\r\n\r\n.cloud-upload-button {\r\n  width: 6rem;\r\n  font-size: 2em;\r\n}\r\n\r\n.cloud-upload-button, .cloud-upload-button:hover {\r\n  border: none;\r\n}\r\n\r\n.suggest-drag-text {\r\n  color: gray;\r\n  margin-top: 1em;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BankList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BankList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BankList.vue?vue&type=template&id=48504eb9&scoped=true&\"\nimport script from \"./BankList.vue?vue&type=script&lang=js&\"\nexport * from \"./BankList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BankList.vue?vue&type=style&index=0&id=48504eb9&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"48504eb9\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-container',[_c('b-row',[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('h2',[_vm._v(\"Your profile\")])])],1),_c('b-row',[_c('b-col',{attrs:{\"md\":\"8\",\"xs\":\"12\"}},[_c('b-form',[_c('label',{attrs:{\"for\":\"username-input\"}},[_vm._v(\"Username\")]),_c('b-form-input',{staticClass:\"mb-2\",attrs:{\"type\":\"text\",\"id\":\"username-input\",\"disabled\":\"\",\"value\":_vm.currentUser.username}}),_c('label',{attrs:{\"for\":\"email-input\"}},[_vm._v(\"Email\")]),_c('b-form-input',{attrs:{\"type\":\"text\",\"id\":\"email-input\",\"disabled\":\"\",\"value\":_vm.currentUser.email}})],1)],1),_c('b-col',{attrs:{\"md\":\"4\",\"xs\":\"12\"}},[_c('profile-picture',{attrs:{\"picture\":_vm.$hostname + '/api/profile-picture/' + _vm.currentUser.username,\"editable\":true}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"profile-picture\",style:('background-image: url(' + _vm.picture + ')')}),(Boolean(_vm.editable))?_c('p',{staticClass:\"text-center\",on:{\"click\":function($event){return _vm.openUploadModal()}}},[_c('a',{attrs:{\"href\":\"#\"}},[_vm._v(\"Upload a new picture\")])]):_vm._e(),_c('b-modal',{attrs:{\"size\":\"lg\",\"title\":\"New avatar\",\"id\":\"upload-picture\",\"hide-footer\":\"\"}},[_c('b-row',{staticClass:\"mb-2\"},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('b-form-file',{attrs:{\"state\":Boolean(_vm.pictureToUpload),\"accept\":\"image/jpeg\",\"placeholder\":\"Upload a new profile picture (.jpg)\",\"drop-placeholder\":\"Drop your file here\"},model:{value:(_vm.pictureToUpload),callback:function ($$v) {_vm.pictureToUpload=$$v},expression:\"pictureToUpload\"}})],1)],1),_c('b-row',[_c('b-col',{attrs:{\"md\":\"6\",\"xs\":\"12\"}},[_c('b-button',{staticClass:\"mb-2\",attrs:{\"variant\":\"primary\",\"disabled\":!_vm.pictureToUpload},on:{\"click\":function($event){return _vm.submitImage()}}},[_c('span',{staticClass:\"mr-2\"},[_vm._v(\"OK\")]),_c('b-icon-upload')],1)],1),_c('b-col',{staticClass:\"d-flex justify-content-md-end\",attrs:{\"md\":\"6\",\"xs\":\"12\"}},[_c('b-button',{attrs:{\"variant\":\"danger\"},on:{\"click\":function($event){return _vm.cancel()}}},[_vm._v(\"Cancel\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"profile-picture\"\r\n         :style=\"'background-image: url(' + picture + ')'\">\r\n    </div>\r\n    <p v-if=\"Boolean(editable)\" class=\"text-center\" @click=\"openUploadModal()\"><a href=\"#\">Upload a new picture</a></p>\r\n    <b-modal size=\"lg\" title=\"New avatar\" id=\"upload-picture\" hide-footer>\r\n      <b-row class=\"mb-2\">\r\n        <b-col cols=\"12\">\r\n          <b-form-file\r\n            v-model=\"pictureToUpload\"\r\n            :state=\"Boolean(pictureToUpload)\"\r\n            accept=\"image/jpeg\"\r\n            placeholder=\"Upload a new profile picture (.jpg)\"\r\n            drop-placeholder=\"Drop your file here\">\r\n          </b-form-file>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row>\r\n        <b-col md=\"6\" xs=\"12\">\r\n          <b-button variant=\"primary\" class=\"mb-2\" @click=\"submitImage()\" :disabled=\"!pictureToUpload\">\r\n            <span class=\"mr-2\">OK</span><b-icon-upload></b-icon-upload>\r\n          </b-button>\r\n        </b-col>\r\n        <b-col md=\"6\" xs=\"12\" class=\"d-flex justify-content-md-end\">\r\n          <b-button variant=\"danger\" @click=\"cancel()\">Cancel</b-button>\r\n        </b-col>\r\n      </b-row>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions } from 'vuex'\r\nimport handleError from '../errors/handler'\r\n\r\nexport default {\r\n  name: 'ProfilePicture',\r\n  data() {\r\n    return {\r\n      pictureToUpload: null,\r\n    }\r\n  },\r\n  props: {\r\n    picture: {\r\n      required: true,\r\n      type: String,\r\n    },\r\n    editable: {\r\n      required: false,\r\n      type: Boolean,\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapActions({ uploadProfilePicture: 'uploadProfilePicture' }),\r\n    openUploadModal() {\r\n      this.$bvModal.show('upload-picture')\r\n    },\r\n    cancel() {\r\n      this.pictureToUpload = null\r\n      this.$bvModal.hide('upload-picture')\r\n    },\r\n    submitImage() {\r\n      this.$bvModal.hide('upload-picture')\r\n      const formData = new FormData()\r\n      formData.append('file', this.pictureToUpload, this.pictureToUpload.name)\r\n      this.uploadProfilePicture({formData}).catch(e => handleError(this.$bvToast, 'Could not upload picture',\r\n          `Cause ${e.response.data.message}`))\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.profile-picture {\r\n  height: 20em;\r\n  background-size: cover;\r\n  background: transparent no-repeat center;\r\n  border-radius: 100%;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfilePicture.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfilePicture.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProfilePicture.vue?vue&type=template&id=82de5c6a&scoped=true&\"\nimport script from \"./ProfilePicture.vue?vue&type=script&lang=js&\"\nexport * from \"./ProfilePicture.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ProfilePicture.vue?vue&type=style&index=0&id=82de5c6a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"82de5c6a\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <b-container>\r\n    <b-row>\r\n      <b-col cols=\"12\">\r\n        <h2>Your profile</h2>\r\n      </b-col>\r\n    </b-row>\r\n    <b-row>\r\n      <b-col md=\"8\" xs=\"12\">\r\n        <b-form>\r\n          <label for=\"username-input\">Username</label>\r\n          <b-form-input type=\"text\" id=\"username-input\"\r\n                        disabled :value=\"currentUser.username\" class=\"mb-2\"/>\r\n          <label for=\"email-input\">Email</label>\r\n          <b-form-input type=\"text\" id=\"email-input\" disabled :value=\"currentUser.email\"/>\r\n        </b-form>\r\n      </b-col>\r\n      <b-col md=\"4\" xs=\"12\">\r\n        <profile-picture :picture=\"$hostname + '/api/profile-picture/' + currentUser.username\" :editable=\"true\" />\r\n      </b-col>\r\n    </b-row>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport ProfilePicture from \"./ProfilePicture\"\r\n\r\nimport {mapGetters} from 'vuex'\r\n\r\nexport default {\r\n  name: 'Settings',\r\n  components: {\r\n    ProfilePicture,\r\n  },\r\n  computed: {\r\n    ...mapGetters({currentUser: 'currentUser'}),\r\n  },\r\n  data() {\r\n    return {\r\n      profilePicture: null,\r\n      imagePlaceholder: { blank: true, blankColor: '#777', width: 75, height: 75, class: 'm1' },\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style>\r\n.form-control:disabled {\r\n  background-color: transparent;\r\n  cursor: text;\r\n  border-color: transparent;\r\n  box-shadow: none;\r\n  outline-color: transparent;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Settings.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Settings.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Settings.vue?vue&type=template&id=5b27875a&\"\nimport script from \"./Settings.vue?vue&type=script&lang=js&\"\nexport * from \"./Settings.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Settings.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-container',[_c('b-row',[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('h2',[_vm._v(\"User profile\")])])],1),_c('b-row',[_c('b-col',{attrs:{\"md\":\"8\",\"xs\":\"12\"}},[_c('b-form',[_c('label',{attrs:{\"for\":\"username-input\"}},[_vm._v(\"Username\")]),_c('b-form-input',{staticClass:\"mb-2\",attrs:{\"type\":\"text\",\"id\":\"username-input\",\"disabled\":\"\",\"value\":_vm.username}}),_c('label',{attrs:{\"for\":\"email-input\"}},[_vm._v(\"Email\")]),_c('b-form-input',{attrs:{\"type\":\"text\",\"id\":\"email-input\",\"disabled\":\"\",\"value\":_vm.email}})],1)],1),_c('b-col',{attrs:{\"md\":\"4\",\"xs\":\"12\"}},[_c('profile-picture',{attrs:{\"picture\":_vm.$hostname + '/api/profile-picture/' + _vm.username,\"editable\":false}})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <b-container>\r\n    <b-row>\r\n      <b-col cols=\"12\">\r\n        <h2>User profile</h2>\r\n      </b-col>\r\n    </b-row>\r\n    <b-row>\r\n      <b-col md=\"8\" xs=\"12\">\r\n        <b-form>\r\n          <label for=\"username-input\">Username</label>\r\n          <b-form-input type=\"text\" id=\"username-input\"\r\n                        disabled :value=\"username\" class=\"mb-2\"/>\r\n          <label for=\"email-input\">Email</label>\r\n          <b-form-input type=\"text\" id=\"email-input\" disabled :value=\"email\"/>\r\n        </b-form>\r\n      </b-col>\r\n      <b-col md=\"4\" xs=\"12\">\r\n        <profile-picture :picture=\"$hostname + '/api/profile-picture/' + username\" :editable=\"false\" />\r\n      </b-col>\r\n    </b-row>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport ProfilePicture from './ProfilePicture'\r\nimport {mapActions} from 'vuex'\r\nimport handleError from '../errors/handler'\r\n\r\nexport default {\r\n  name: 'Profile',\r\n  data() {\r\n    return {\r\n      username: '',\r\n      email: '',\r\n    }\r\n  },\r\n  components: {\r\n    ProfilePicture,\r\n  },\r\n  methods: {\r\n    ...mapActions({fetchUserData: 'fetchUserData'}),\r\n  },\r\n  created() {\r\n    this.fetchUserData({username: this.$route.params.username}).then(res => {\r\n      this.username = res.data.username\r\n      this.email = res.data.email\r\n    }).catch(e => handleError(this.$bvToast, 'Could not load user info', `Cause: ${e.response.data.message}`))\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Profile.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Profile.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Profile.vue?vue&type=template&id=09ed5c84&\"\nimport script from \"./Profile.vue?vue&type=script&lang=js&\"\nexport * from \"./Profile.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\r\nimport Router from 'vue-router'\r\n// import components\r\nimport AnnotateImage from '../components/AnnotateImage.vue'\r\nimport ImageList from '../components/ImageList.vue'\r\nimport Login from '../components/Login.vue'\r\nimport Register from '../components/Register.vue'\r\nimport BankList from '../components/BankList.vue'\r\nimport Settings from '../components/Settings.vue'\r\nimport Profile from '../components/Profile.vue'\r\n\r\nVue.use(Router)\r\n\r\nexport default new Router({\r\n  mode: 'history',\r\n  base: process.env.BASE_URL,\r\n  routes: [\r\n    {\r\n      path: '/',\r\n      name: 'BankList',\r\n      component: BankList,\r\n    },\r\n    {\r\n      path: '/annotate/:imageId',\r\n      name: 'AnnotateImage',\r\n      component: AnnotateImage,\r\n    },\r\n    {\r\n      path: '/bank/:bankId',\r\n      name: 'ImageList',\r\n      component: ImageList,\r\n    },\r\n    {\r\n      path: '/login',\r\n      name: 'Login',\r\n      component: Login,\r\n      meta: { noAuth: true },\r\n    },\r\n    {\r\n      path: '/register',\r\n      name: 'Register',\r\n      component: Register,\r\n      meta: { noAuth: true },\r\n    },\r\n    {\r\n      path: '/settings',\r\n      name: 'Settings',\r\n      component: Settings,\r\n    },\r\n    {\r\n      path: '/profile/:username',\r\n      name: 'Profile',\r\n      component: Profile,\r\n    },\r\n  ],\r\n})\r\n","import axios from 'axios'\r\nimport * as Cookies from 'js-cookie'\r\n\r\nconst state = {\r\n    userInfo: null,\r\n}\r\n\r\nconst mutations = {\r\n    setUserInfo(state, {userInfo}) {\r\n        state.userInfo = userInfo\r\n    },\r\n    deleteInfo(state) {\r\n        state.userInfo = null\r\n    },\r\n}\r\n\r\nconst actions = {\r\n    logIn({commit}, {formData}) {\r\n        return axios.post('/login', formData).then(res => {\r\n            const userInfo = res.data\r\n            commit('setUserInfo', {userInfo})\r\n        })\r\n    },\r\n    logOut({commit}) {\r\n        return axios.post('/logout').then(_ => {\r\n            commit('deleteInfo')\r\n        })\r\n    },\r\n    registerAccount({commit}, {registrationForm}) {\r\n        return axios.post('/register', registrationForm).then(res => {\r\n            const userInfo = res.data\r\n            commit('setUserInfo', {userInfo})\r\n        })\r\n    },\r\n}\r\n\r\nconst getters = {\r\n    currentUser(state) {\r\n        return state.userInfo\r\n    },\r\n    isLoggedIn(state) {\r\n        // IMPORTANT NOTE: do not remove the two following lines, they somehow fix a bug\r\n        // noted on Firefox that forced refreshing the page to be logged in.\r\n        Cookies.get('session')\r\n        state.userInfo\r\n        return !!(Cookies.get('session')) && !!(state.userInfo)\r\n    },\r\n}\r\n\r\nexport default {\r\n    state,\r\n    getters,\r\n    actions,\r\n    mutations,\r\n}\r\n","import axios from 'axios'\r\n\r\nconst actions = {\r\n    listBanks({dispatch}) {\r\n        return axios.get('/api/bank-list')\r\n    },\r\n    listImages({dispatch}, {bankId}) {\r\n        return axios.get('/api/bank/' + bankId)\r\n    },\r\n    listAccesses({dispatch}, {bankId}) {\r\n        return axios.get('/api/bank-list-accesses/' + bankId)\r\n    },\r\n    requestPermission({dispatch}, {targetUser, level, bankId}) {\r\n        return axios.put('/api/bank-access', {targetName: targetUser, level, id: bankId})\r\n    },\r\n    fetchImageData({dispatch}, {imageId}) {\r\n        return axios.get('/api/image/' + imageId)\r\n    },\r\n    sendAnnotations({dispatch}, {data}) {\r\n        return axios.post('/api/image/annotate', data)\r\n    },\r\n    requestBankJson({dispatch}, {bankId}) {\r\n        return axios.get('/api/bank/json/' + bankId)\r\n    },\r\n    uploadBank({dispatch}, {formData}) {\r\n        return axios.post('/api/bank/upload', formData, {\r\n            headers: {\r\n                'Content-Type': 'multipart/form-data',\r\n            },\r\n        })\r\n    },\r\n    deleteBank({dispatch}, {bankId}) {\r\n        return axios.get('/api/bank/delete/' + bankId)\r\n    },\r\n}\r\n\r\nexport default {\r\n    actions,\r\n}","import axios from 'axios'\r\n\r\nconst actions = {\r\n    uploadProfilePicture({dispatch}, {formData}) {\r\n        return axios.post('/api/profile-picture', formData, {\r\n            headers: {\r\n                'Content-Type': 'multipart/form-data',\r\n            },\r\n        })\r\n    },\r\n    fetchUserData({dispatch}, {username}) {\r\n        return axios.get('/api/user-info/' + username)\r\n    },\r\n}\r\n\r\nexport default {\r\n    actions,\r\n}\r\n","import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport createPersistedState from 'vuex-persistedstate'\r\nimport auth from './auth'\r\nimport images from './images'\r\nimport profiles from './profiles'\r\nimport * as Cookies from 'js-cookie'\r\n\r\nVue.use(Vuex)\r\n\r\nconst userData = new Vuex.Store({\r\n    modules: {auth, images, profiles},\r\n    plugins: [createPersistedState({\r\n        getState: key => Cookies.get(key) ? JSON.parse(Cookies.get(key)) : null,\r\n        setState: (key, state) => Cookies.set(key, JSON.stringify(state)),\r\n    })],\r\n})\r\n\r\nexport default userData\r\n","import router from './router'\r\nimport userData from './store'\r\n\r\n// guard for authentication\r\nrouter.beforeEach((to, from, next) => {\r\n    if (to.meta.noAuth) {\r\n        next()\r\n    } else {\r\n        // requires logging in\r\n        if (userData.getters.isLoggedIn) {\r\n            next() // is logged in; proceed\r\n        } else {\r\n            next({ path: '/login' }) // not logged in\r\n        }\r\n    }\r\n})\r\n","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport router from './router'\r\nimport store from './store'\r\nimport axios from 'axios'\r\nimport 'bootstrap/dist/css/bootstrap.css'\r\nimport {BootstrapVue, BootstrapVueIcons} from 'bootstrap-vue'\r\nimport 'bootstrap-vue/dist/bootstrap-vue.css'\r\nimport * as VeeValidate from 'vee-validate'\r\nimport * as _ from './permission'\r\nimport VueTippy, { TippyComponent } from 'vue-tippy'\r\nimport 'tippy.js/themes/google.css'\r\n\r\naxios.defaults.withCredentials = true\r\nconst apiUrl = process.env.VUE_APP_ROOT_API\r\n// default Flask port = 5000\r\naxios.defaults.baseURL = apiUrl\r\nVue.prototype.$hostname = apiUrl\r\n\r\nVue.use(BootstrapVue)\r\nVue.use(BootstrapVueIcons)\r\nVue.use(VeeValidate, {\r\n    inject: true,\r\n    fieldsBagName: 'veeFields',\r\n    errorBagName: 'veeErrors',\r\n})\r\nVue.use(VueTippy, {\r\n    directive: 'tippy',\r\n})\r\n\r\nVue.component('tippy', TippyComponent)\r\nVue.config.productionTip = false\r\nVue.use(BootstrapVue)\r\n\r\nnew Vue({\r\n    store,\r\n    router,\r\n    render: h => h(App),\r\n}).$mount('#app')\r\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Footer.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Header.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BankList.vue?vue&type=style&index=0&id=48504eb9&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImageList.vue?vue&type=style&index=0&id=35e05470&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfilePicture.vue?vue&type=style&index=0&id=82de5c6a&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AnnotateImage.vue?vue&type=style&index=0&id=0fad4d3d&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Settings.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DescriptionBit.vue?vue&type=style&index=0&id=52de14c2&scoped=true&lang=css&\""],"sourceRoot":""}